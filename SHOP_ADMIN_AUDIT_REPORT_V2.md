# SHOP ADMIN ‚Äì Audit automatique (V2)

- Date (UTC): 2026-02-11 23:14:20Z
- Repo: /workspaces/MASLIVE
- Dossier Dart scann√©: app/lib

## 1) Arborescence (top-level)

total 2388
drwxrwxrwx+  12 vscode root   20480 Feb 11 23:14 .
drwxr-xrwx+   5 vscode root    4096 Feb  8 14:48 ..
-rw-rw-rw-    1 vscode vscode  6114 Feb 10 02:08 00_README_FIRST.md
-rw-rw-rw-    1 vscode vscode   825 Feb 10 02:08 activate_shop_v21.sh
-rw-rw-rw-    1 vscode vscode    86 Feb 10 02:07 add_product.dart
-rw-rw-rw-    1 vscode vscode  6954 Feb 10 02:08 ADMIN_DASHBOARD_STRUCTURE.md
-rw-rw-rw-    1 vscode vscode  3853 Feb 10 02:08 ADMIN_NAVIGATION_VERIFIED.md
-rw-rw-rw-    1 vscode vscode  6525 Feb 10 02:07 ADMIN_POPUP_MODIFICATIONS.md
-rw-rw-rw-    1 vscode vscode 14674 Feb 10 02:07 AMELIORATIONS_ARTICLES_10_10.md
drwxrwxrwx+  18 vscode vscode  4096 Feb 11 11:35 app
-rw-rw-rw-    1 vscode vscode 24777 Feb 10 02:08 ARCHITECTURE_VISUAL.md
-rw-rw-rw-    1 vscode vscode  9618 Feb 10 02:07 AUDIT_ARTICLES_PHOTO_UPLOAD.md
-rw-rw-rw-    1 vscode vscode  9751 Feb 10 02:08 AUDIT_FINAL_ARTICLES_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  4207 Feb 11 18:03 AUDIT_SHOP.md
-rw-rw-rw-    1 vscode vscode 14642 Feb 10 02:07 AUDIT_STORAGE_ARTICLES.md
-rw-rw-rw-    1 vscode vscode 13154 Feb 10 02:08 AUDIT_UPLOAD_ARTICLES_COMPLETE.md
-rw-rw-rw-    1 vscode vscode  6997 Feb 11 18:16 AUDIT_UX_BOUTIQUE.md
-rw-rw-rw-    1 vscode vscode  1305 Feb 10 02:08 BUILD_AND_DEPLOY_HOSTING.md
-rw-rw-rw-    1 vscode vscode   510 Feb 10 02:08 build_and_deploy_hosting.sh
-rw-rw-rw-    1 vscode vscode   255 Feb 10 02:08 build_deploy_now.sh
-rw-rw-rw-    1 vscode vscode   587 Feb 10 02:08 check_analyzer.sh
-rw-rw-rw-    1 vscode vscode  1177 Feb 10 02:08 check_errors.sh
-rw-rw-rw-    1 vscode vscode  7010 Feb 10 02:08 CIRCUIT_WIZARD_PRO_GUIDE.dart
-rwxrwxrwx    1 vscode vscode   771 Feb 10 02:08 clean_and_run_web.sh
-rw-rw-rw-    1 vscode vscode  1053 Feb 10 02:08 clean_build_deploy.sh
-rw-rw-rw-    1 vscode vscode   722 Feb 10 02:08 CLEANUP_COMPLETE.md
-rw-rw-rw-    1 vscode vscode  1937 Feb 10 02:08 cleanup_git_history.sh
-rw-rw-rw-    1 vscode vscode  2066 Feb 10 02:08 cleanup_test_products.js
-rw-rw-rw-    1 vscode vscode 10299 Feb 10 02:08 COMMERCE_TEST_GUIDE.md
-rw-rw-rw-    1 vscode vscode 11098 Feb 10 02:08 COMMERCE_V2_IMPROVEMENTS.md
-rw-rw-rw-    1 vscode vscode  1924 Feb 10 02:08 commit_and_push_now.sh
-rwxrwxrwx    1 vscode vscode  4197 Feb 11 22:35 commit_push_build_deploy.sh
-rw-rw-rw-    1 vscode vscode   883 Feb 10 02:08 commit_quality_fixes.sh
-rw-rw-rw-    1 vscode vscode 12047 Feb 10 02:07 CONFIG_GROUP_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  4456 Feb 10 02:07 configure_mapbox_now.sh
-rw-rw-rw-    1 vscode vscode  1063 Feb 10 02:08 COPY_PASTE_COMMANDS.md
-rw-rw-rw-    1 vscode vscode  6123 Feb 11 18:26 CORRECTIONS_BOUTIQUE_2026-02-11.md
-rw-rw-rw-    1 vscode vscode 15443 Feb 10 02:07 DASHBOARD_AUDIT_ARTICLES.md
-rw-rw-rw-    1 vscode vscode  8907 Feb 10 02:08 DELIVERABLE_FINAL.md
-rw-rw-rw-    1 vscode vscode 12066 Feb 10 02:08 DELIVERABLE_IMAGE_SYSTEM.md
-rw-rw-rw-    1 vscode vscode 12442 Feb 10 02:08 DELIVERABLE_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  7606 Feb 10 02:07 DEMARRAGE_RAPIDE_AUDIT.md
-rw-rw-rw-    1 vscode vscode  2787 Feb 10 02:08 DEPLOY_COMMAND.md
-rw-rw-rw-    1 vscode vscode  1697 Feb 10 02:08 DEPLOY_COMMANDS.txt
-rw-rw-rw-    1 vscode vscode  2755 Feb 10 02:08 deploy_complete.sh
-rw-rw-rw-    1 vscode vscode   858 Feb 10 02:07 deploy_firebase.sh
-rw-rw-rw-    1 vscode vscode  1676 Feb 10 02:07 deploy_functions_stripe.sh
-rw-rw-rw-    1 vscode vscode  4129 Feb 10 02:08 deploy_group_tracking.sh
-rwxrwxrwx    1 vscode vscode  1888 Feb 10 02:08 deploy_i18n_now.sh
-rw-rw-rw-    1 vscode vscode  1484 Feb 10 02:08 deploy_i18n.sh
-rw-rw-rw-    1 vscode vscode 11925 Feb 10 02:08 deploy_image_system.sh
-rw-rw-rw-    1 vscode vscode   924 Feb 10 02:08 deploy_main_fast.sh
-rw-rw-rw-    1 vscode vscode  2009 Feb 10 02:08 deploy_main.sh
-rw-rw-rw-    1 vscode vscode  6501 Feb 10 02:08 DEPLOY_MANUAL_STEPS.md
-rwxrwxrwx    1 vscode vscode  5067 Feb 10 02:08 deploy_map_visibility_now.sh
-rw-rw-rw-    1 vscode vscode  8721 Feb 10 02:08 DEPLOYMENT_CHECKLIST_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  8220 Feb 10 02:08 DEPLOYMENT_CHECKLIST.md
-rw-rw-rw-    1 vscode vscode  5085 Feb 10 02:08 DEPLOYMENT_COMMANDS.md
-rw-rw-rw-    1 vscode vscode  2619 Feb 10 02:08 DEPLOYMENT_COMPLETE.md
-rw-rw-rw-    1 vscode vscode 10441 Feb 10 02:07 DEPLOYMENT_IMAGE_SYSTEM.md
-rw-rw-rw-    1 vscode vscode  5704 Feb 10 02:07 DEPLOYMENT_STATUS_20260124.md
-rw-rw-rw-    1 vscode vscode  1654 Feb 10 02:08 DEPLOY_NOW.md
-rw-rw-rw-    1 vscode vscode  3314 Feb 10 02:08 DEPLOY_NOW.sh
-rw-rw-rw-    1 vscode vscode  3049 Feb 10 02:07 deploy_production.sh
-rw-rw-rw-    1 vscode vscode  5284 Feb 10 02:08 deploy.sh
-rw-rw-rw-    1 vscode vscode  1218 Feb 10 02:08 DEPLOY_SHOP_NOW.md
-rwxrwxrwx    1 vscode vscode  1580 Feb 10 02:08 deploy_shop.sh
-rw-rw-rw-    1 vscode vscode  3850 Feb 10 02:08 deploy_superadmin_articles.sh
drwxrwxrwx+   2 vscode vscode  4096 Feb 10 02:08 .devcontainer
drwxrwxrwx+   2 vscode vscode  4096 Feb 10 02:07 docs
-rw-rw-rw-    1 vscode vscode  8664 Feb 10 02:08 DOCUMENTATION_INDEX.md
-rw-rw-rw-    1 vscode vscode  6507 Feb 10 02:08 DOCUMENTS_CREATED.md
-rw-rw-rw-    1 vscode vscode 17172 Feb 10 02:08 E2E_TESTS_GUIDE.md
-rw-rw-rw-    1 vscode vscode   358 Feb 10 02:08 .env
-rw-rw-rw-    1 vscode vscode   254 Feb 10 02:08 .env.example
-rw-rw-rw-    1 vscode vscode 12145 Feb 10 02:08 EXECUTIVE_SUMMARY_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  8614 Feb 10 02:08 FEATURE_GROUP_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode 13904 Feb 10 02:07 FILE_MANIFEST_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  1460 Feb 10 02:08 final_commit.sh
-rw-rw-rw-    1 vscode vscode  4788 Feb 10 02:08 FINAL_DEPLOYMENT_CHECKLIST.md
-rw-rw-rw-    1 vscode vscode  8887 Feb 10 02:08 FINAL_SUMMARY.md
drwxrwxrwx+   2 vscode vscode  4096 Feb 10 02:07 .firebase
-rw-rw-rw-    1 vscode vscode  7043 Feb 10 02:08 firebase_config_report_20260116_180131.txt
-rw-rw-rw-    1 vscode vscode  2060 Feb 10 02:07 firebase.json
-rw-rw-rw-    1 vscode vscode   105 Feb 10 02:08 .firebaserc
-rw-rw-rw-    1 vscode vscode  8614 Feb 10 02:08 FIRESTORE_EXAMPLES.md
-rw-rw-rw-    1 vscode vscode  8616 Feb 10 02:08 firestore.indexes.json
-rw-rw-rw-    1 vscode vscode 26850 Feb 10 02:07 FIRESTORE_MAP_PROJECTS_SCHEMA.md
-rw-rw-rw-    1 vscode vscode 27806 Feb 11 18:13 firestore.rules
-rw-rw-rw-    1 vscode vscode   562 Feb 10 02:08 fix_and_deploy.sh
-rw-rw-rw-    1 vscode vscode  4211 Feb 10 02:08 FIX_GITHUB_PUSH_PROTECTION.md
-rw-rw-rw-    1 vscode vscode  1973 Feb 10 02:08 fix_imports.sh
-rw-rw-rw-    1 vscode vscode   852 Feb 10 02:07 fix_push_and_deploy.sh
-rw-rw-rw-    1 vscode vscode   222 Feb 10 02:07 flutter_clean_get.sh
-rw-rw-rw-    1 vscode vscode  2415 Feb 10 02:08 flutter_doctor.txt
-rw-rw-rw-    1 vscode vscode   826 Feb 10 02:07 force_push_now.sh
-rw-rw-rw-    1 vscode vscode  1699 Feb 10 02:07 FORCE_PUSH_SOLUTION.md
drwxrwxrwx+   5 vscode vscode  4096 Feb 10 02:08 functions
drwxrwxrwx+   8 vscode root    4096 Feb 11 22:54 .git
-rw-rw-rw-    1 vscode vscode  2263 Feb 10 02:08 git_commit_push_build_deploy.sh
-rw-rw-rw-    1 vscode vscode   454 Feb 10 02:08 git_commit_quality.sh
-rw-rw-rw-    1 vscode vscode   293 Feb 10 02:08 .gitcommit.tmp
drwxrwxrwx+   3 vscode vscode  4096 Jan 30 05:14 .github
-rw-rw-rw-    1 vscode vscode  3057 Feb 10 02:08 .gitignore
-rw-rw-rw-    1 vscode vscode  1372 Feb 10 02:08 git_push_main.sh
-rw-rw-rw-    1 vscode vscode  4806 Feb 10 02:08 GO_FOR_DEPLOYMENT.md
-rw-rw-rw-    1 vscode vscode 10741 Feb 10 02:08 GPS_AVERAGE_LOGIC_VERIFICATION.md
-rw-rw-rw-    1 vscode vscode  4161 Feb 10 02:08 GPS_AVERAGE_SUMMARY.md
-rw-rw-rw-    1 vscode vscode 11293 Feb 10 02:07 GROUP_TRACKING_DELIVERABLE.md
-rw-rw-rw-    1 vscode vscode  6278 Feb 10 02:07 GROUP_TRACKING_DEPLOYMENT.md
-rw-rw-rw-    1 vscode vscode  3292 Feb 10 02:08 GROUP_TRACKING_README.md
-rw-rw-rw-    1 vscode vscode  5622 Feb 10 02:08 GROUP_TRACKING_STATUS.md
-rw-rw-rw-    1 vscode vscode 11961 Feb 10 02:07 GROUP_TRACKING_SYSTEM_GUIDE.md
-rw-rw-rw-    1 vscode vscode 13083 Feb 10 02:08 GROUP_TRACKING_TODO.md
-rw-rw-rw-    1 vscode vscode 14545 Feb 10 02:07 GROUP_TRACKING_VERIFICATION.md
-rw-rw-rw-    1 vscode vscode  7502 Feb 10 02:08 GUIDES_INDEX.md
-rw-rw-rw-    1 vscode vscode  3960 Feb 10 02:07 HOMEPAGE_CONFIG_COMMIT_0b19da0.md
-rw-rw-rw-    1 vscode vscode  6546 Feb 10 02:08 I18N_IMPLEMENTATION.md
-rw-rw-rw-    1 vscode vscode  6411 Feb 10 02:08 I18N_READY.md
-rw-rw-rw-    1 vscode vscode 12289 Feb 10 02:08 IMAGE_MANAGEMENT_SYSTEM.md
-rw-rw-rw-    1 vscode vscode 10425 Feb 10 02:08 IMAGE_SYSTEM_INDEX.md
-rw-rw-rw-    1 vscode vscode 14141 Feb 10 02:08 IMAGE_SYSTEM_README.md
-rw-rw-rw-    1 vscode vscode 11770 Feb 10 02:08 IMPLEMENTATION_5_AMELIORATIONS.md
-rw-r--r--    1 vscode vscode 68405 Feb 10 02:10 -iname *i18n*.json -o -iname locales*.json
-rw-rw-rw-    1 vscode vscode  9931 Feb 10 02:08 INDEX_AUDIT_ARTICLES.md
-rw-rw-rw-    1 vscode vscode 13772 Feb 10 02:08 INDEX_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  3334 Feb 10 02:08 init_articles.js
-rw-rw-rw-    1 vscode vscode  2221 Feb 10 02:07 inspect_shop_products.js
-rw-rw-rw-    1 vscode vscode  2619 Feb 10 02:08 INTEGRATION_EXAMPLES.dart
-rw-rw-rw-    1 vscode vscode 12391 Feb 10 02:08 JOURNAL_MAP_VISIBILITY_IMPLEMENTATION.md
-rw-rw-rw-    1 vscode vscode  1066 Feb 10 02:08 LICENSE
-rw-rw-rw-    1 vscode vscode 10386 Feb 10 02:07 LIVRABLES_AUDIT_ARTICLES.md
-rw-rw-rw-    1 vscode vscode  4923 Feb 10 02:08 LIVRAISON_MAPBOX.md
-rw-rw-rw-    1 vscode vscode  6438 Feb 10 02:08 MAPBOX_3D_IMPLEMENTATION.md
-rw-rw-rw-    1 vscode vscode 12738 Feb 10 02:07 MAPBOX_AUDIT_AND_FIXES.md
-rw-rw-rw-    1 vscode vscode  6941 Feb 10 02:08 MAPBOX_AUDIT_CHECKLIST.md
-rw-rw-rw-    1 vscode vscode  7139 Feb 10 02:07 MAPBOX_AUDIT_COMPLETE.md
-rw-rw-rw-    1 vscode vscode  4570 Feb 10 02:08 MAPBOX_AUDIT_FINAL_REPORT.md
-rw-rw-rw-    1 vscode vscode  1681 Feb 10 02:08 MAPBOX_AUDIT_FINISHED.md
-rw-rw-rw-    1 vscode vscode  5645 Feb 10 02:08 MAPBOX_BUILD_DEPLOY_GUIDE.md
-rw-rw-rw-    1 vscode vscode  2740 Feb 10 02:08 mapbox_build_deploy.sh
-rw-rw-rw-    1 vscode vscode  3485 Feb 10 02:08 MAPBOX_CIRCUIT_FIX.md
-rw-rw-rw-    1 vscode vscode  6074 Feb 10 02:07 MAPBOX_COMMIT_GUIDE.md
-rw-rw-rw-    1 vscode vscode  5839 Feb 10 02:07 MAPBOX_COMPLETION_REPORT.txt
-rw-rw-rw-    1 vscode vscode  3477 Feb 10 02:08 MAPBOX_CONFIG_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  5351 Feb 10 02:07 MAPBOX_CONFIGURATION.md
-rw-rw-rw-    1 vscode vscode  3747 Feb 10 02:07 MAPBOX_DART_DEFINE.md
-rw-rw-rw-    1 vscode vscode  8961 Feb 10 02:08 MAPBOX_DELIVERABLES.md
-rw-rw-rw-    1 vscode vscode  2604 Feb 10 02:07 MAPBOX_DELIVERY_COMPLETE.txt
-rw-rw-rw-    1 vscode vscode  9459 Feb 10 02:08 MAPBOX_DEMO_USAGE.md
-rw-rw-rw-    1 vscode vscode  3914 Feb 10 02:08 MAPBOX_DEPLOYMENT_GUIDE.md
-rw-rw-rw-    1 vscode vscode  7323 Feb 10 02:08 MAPBOX_DOCS_INDEX.md
-rw-rw-rw-    1 vscode vscode  8869 Feb 10 02:08 MAPBOX_FILES_CREATED.md
-rw-rw-rw-    1 vscode vscode  7620 Feb 10 02:08 MAPBOX_FILES_MODIFIED_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  3408 Feb 10 02:08 MAPBOX_FINAL.md
-rw-rw-rw-    1 vscode vscode  9895 Feb 10 02:08 MAPBOX_FINAL_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  4464 Feb 10 02:08 MAPBOX_FIXES_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  3590 Feb 10 02:08 MAPBOX_FLUTTERMAP_AUDIT_20260131.md
-rw-rw-rw-    1 vscode vscode 14500 Feb 10 02:08 MAPBOX_IMPLEMENTATION_COMPLETE.md
-rw-rw-rw-    1 vscode vscode  7313 Feb 10 02:07 MAPBOX_INDEX.md
-rw-rw-rw-    1 vscode vscode  3023 Feb 10 02:08 MAPBOX_INTEGRATION_STATUS.md
-rw-rw-rw-    1 vscode vscode  7540 Feb 10 02:08 MAPBOX_MISSION_COMPLETE.md
-rw-rw-rw-    1 vscode vscode  3328 Feb 10 02:08 MAPBOX_QUICK_START.md
-rw-rw-rw-    1 vscode vscode  3201 Feb 10 02:08 MAPBOX_QUICK_START.txt
-rw-rw-rw-    1 vscode vscode  7344 Feb 10 02:07 MAPBOX_READY_FOR_MERGE.md
-rw-rw-rw-    1 vscode vscode  3316 Feb 10 02:08 MAPBOX_SETUP_QUICK.md
-rw-rw-rw-    1 vscode vscode  4191 Feb 10 02:08 MAPBOX_START_HERE.md
-rw-rw-rw-    1 vscode vscode  3337 Feb 10 02:07 mapbox-start.sh
-rw-rw-rw-    1 vscode vscode  7597 Feb 10 02:08 MAPBOX_STATUS_COMPLETE.md
-rw-rw-rw-    1 vscode vscode  7577 Feb 10 02:08 MAPBOX_TECHNICAL_SUMMARY.md
-rw-rw-rw-    1 vscode vscode 10955 Feb 10 02:08 MAPBOX_TOKEN_SETUP.md
-rw-rw-rw-    1 vscode vscode  8612 Feb 10 02:08 MAPBOX_VALIDATION.md
-rw-rw-rw-    1 vscode vscode 10053 Feb 10 02:07 MAPBOX_VALIDATION_REPORT.md
-rw-rw-rw-    1 vscode vscode 20323 Feb 10 02:08 MAPBOX_VISUAL_OVERVIEW.md
-rw-rw-rw-    1 vscode vscode 11040 Feb 10 02:08 MAPBOX_WEB_GL_IMPLEMENTATION.md
-rw-rw-rw-    1 vscode vscode  6280 Feb 10 02:08 MAPBOX_WHAT_WAS_DONE.md
-rw-rw-rw-    1 vscode vscode  4217 Feb 10 02:07 MAPBOX_WIZARD_UPDATE.md
-rw-rw-rw-    1 vscode vscode  6508 Feb 10 02:08 MAP_DISPLAY_CONFIG.md
-rw-rw-rw-    1 vscode vscode  4985 Feb 10 02:07 MAPMARKET_HOME_INTEGRATION.md
-rw-rw-rw-    1 vscode vscode  9246 Feb 10 02:08 MAPMARKET_WIZARD_COMPLETE.md
-rw-rw-rw-    1 vscode vscode  5935 Feb 10 02:07 MAP_PERMISSIONS_IMPLEMENTATION.md
-rw-rw-rw-    1 vscode vscode  4660 Feb 10 02:08 MAP_PRESETS_IMPLEMENTATION_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  6533 Feb 10 02:07 MAP_PRESETS_SYSTEM.md
-rw-rw-rw-    1 vscode vscode  2361 Feb 10 02:08 maslive-firebase-adminsdk-fbsvc-c6d30fab6a.json
-rw-rw-rw-    1 vscode vscode  5585 Feb 10 02:08 MASLIVE_MAP_SYSTEM.md
-rw-rw-rw-    1 vscode vscode 10777 Feb 10 02:07 MASLIVE_MAP_USAGE.md
-rw-rw-rw-    1 vscode vscode  7547 Feb 10 02:08 MEDIA_COMPARISON.md
-rw-rw-rw-    1 vscode vscode  5962 Feb 10 02:07 MEDIA_SHOP_README.md
-rw-rw-rw-    1 vscode vscode  4934 Feb 10 02:08 MEDIA_SHOP_STRUCTURE.md
-rw-rw-rw-    1 vscode vscode  5072 Feb 10 02:08 migrate_shop_products.js
drwxrwxrwx+ 130 vscode vscode  4096 Feb 10 02:07 node_modules
-rw-rw-rw-    1 vscode vscode    60 Feb 10 02:08 package.json
-rw-rw-rw-    1 vscode vscode 69710 Feb 10 02:08 package-lock.json
-rw-rw-rw-    1 vscode vscode  6907 Feb 10 02:08 PERMISSIONS_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  6796 Feb 10 02:07 POI_ASSISTANT_DELIVERY.md
-rw-rw-rw-    1 vscode vscode  5667 Feb 10 02:08 POI_ASSISTANT_OVERVIEW.md
-rw-rw-rw-    1 vscode vscode 16350 Feb 10 02:08 POI_ASSISTANT_VISUAL_FLOW.md
-rw-rw-rw-    1 vscode vscode  5746 Feb 10 02:08 PRE_PRODUCTION_CHECKLIST.md
-rw-rw-rw-    1 vscode vscode    96 Feb 10 02:08 push_now.sh
-rw-rw-rw-    1 vscode vscode   835 Feb 10 02:08 quick_deploy.sh
-rw-rw-rw-    1 vscode vscode  8621 Feb 10 02:07 QUICK_REFERENCE_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  8152 Feb 10 02:08 QUICK_START_I18N.md
-rw-rw-rw-    1 vscode vscode  1332 Feb 10 02:07 QUICK_STRIPE_DEPLOY.md
-rw-rw-rw-    1 vscode vscode 15750 Feb 10 02:07 RAPPORT_COMPLET_STRENGTHS_WEAKNESSES.md
-rw-rw-rw-    1 vscode vscode  4962 Feb 10 02:08 README_MAPBOX_AUDIT.md
-rw-rw-rw-    1 vscode vscode  5174 Feb 10 02:08 README_MAPBOX.md
-rw-rw-rw-    1 vscode vscode 14770 Feb 10 02:08 README_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode   598 Feb 10 02:08 README.md
-rw-rw-rw-    1 vscode vscode  9956 Feb 10 02:07 README_SUPERADMIN_ARTICLES.md
-rw-rw-rw-    1 vscode vscode  4772 Feb 10 02:08 README_V21_STRIPE_READY.md
-rw-rw-rw-    1 vscode vscode  3437 Feb 10 02:08 REGENERATE_CREDENTIALS_GUIDE.md
-rw-rw-rw-    1 vscode vscode   430 Feb 10 02:08 remove_assistant_file.sh
-rw-rw-rw-    1 vscode vscode  7511 Feb 10 02:08 RESOLUTION_COMPLETE_5_AMELIORATIONS.md
-rw-rw-rw-    1 vscode vscode  8623 Feb 10 02:07 RESUME_FINAL_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode 11152 Feb 10 02:08 ROLES_AND_PERMISSIONS.md
-rw-rw-rw-    1 vscode vscode   659 Feb 10 02:07 run_flutter_web_clean.sh
-rw-rw-rw-    1 vscode vscode 23084 Feb 10 02:07 run_verbose.txt
drwxrwxrwx+   3 vscode vscode  4096 Feb 10 02:08 scripts
-rw-rw-rw-    1 vscode vscode  4759 Feb 11 22:34 SECURITY_FIX_STRIPE.md
-rw-rw-rw-    1 vscode vscode  2288 Feb 10 02:08 SECURITY_FIX_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  4161 Feb 10 02:08 seed_demo_products.js
-rw-rw-rw-    1 vscode vscode  2360 Feb 10 02:07 serviceAccountKey.json
-rw-rw-rw-    1 vscode vscode   751 Feb 10 02:08 setup_and_test_improvements.sh
-rw-rw-rw-    1 vscode vscode  1666 Feb 10 02:08 setup_i18n.sh
-rw-rw-rw-    1 vscode vscode 21804 Feb 11 23:11 SHOP_ADMIN_AUDIT_REPORT.md
-rw-rw-rw-    1 vscode vscode   169 Feb 11 23:14 SHOP_ADMIN_AUDIT_REPORT_V2.md
-rw-rw-rw-    1 vscode vscode  9028 Feb 10 02:08 START_HERE_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode  4991 Feb 10 02:08 START_HERE.md
-rw-rw-rw-    1 vscode vscode  3816 Feb 10 02:07 START_HERE_V21_STRIPE.md
-rw-rw-rw-    1 vscode vscode 14027 Feb 10 02:08 STATUS_MAP_VISIBILITY_DEPLOYMENT.md
-rw-rw-rw-    1 vscode vscode  3601 Feb 10 02:07 storage.rules
-rw-rw-rw-    1 vscode vscode  8215 Feb 10 02:07 STORAGE_STRUCTURE.md
-rw-rw-rw-    1 vscode vscode 13535 Feb 10 02:08 STORAGE_UPLOAD_VERIFICATION.md
-rw-rw-rw-    1 vscode vscode  1062 Feb 10 02:07 STRIPE_CONFIG_QUICK.md
-rw-rw-rw-    1 vscode vscode   587 Feb 10 02:07 STRIPE_CONFIGURED.md
-rw-rw-rw-    1 vscode vscode  2633 Feb 10 02:07 STRIPE_CORRECTION_LOG.md
-rw-rw-rw-    1 vscode vscode  3357 Feb 10 02:08 STRIPE_SETUP.md
-rw-rw-rw-    1 vscode vscode  2970 Feb 10 02:07 STRIPE_STATUS_OK.md
-rw-rw-rw-    1 vscode vscode  4453 Feb 10 02:07 STRIPE_VERIFICATION_REPORT.md
-rw-rw-rw-    1 vscode vscode   984 Feb 10 02:08 STRIPE_VERIFIED.md
-rw-rw-rw-    1 vscode vscode  5258 Feb 10 02:08 STRIPE_WEBHOOK_SETUP.md
-rw-rw-rw-    1 vscode vscode  1810 Feb 10 02:07 SUMMARY_READY_TO_DEPLOY.md
-rw-rw-rw-    1 vscode vscode 12291 Feb 10 02:07 SUPERADMIN_ARTICLES_ARCHITECTURE.md
-rw-rw-rw-    1 vscode vscode  9218 Feb 10 02:07 SUPERADMIN_ARTICLES_DEPLOYMENT_CHECKLIST.md
-rw-rw-rw-    1 vscode vscode  9516 Feb 10 02:08 SUPERADMIN_ARTICLES_GUIDE.md
-rw-rw-rw-    1 vscode vscode 10072 Feb 10 02:08 SUPERADMIN_ARTICLES_INVENTORY.md
-rw-rw-rw-    1 vscode vscode  5013 Feb 10 02:08 SUPERADMIN_ARTICLES_QUICKSTART.md
-rw-rw-rw-    1 vscode vscode  6892 Feb 10 02:08 SUPERADMIN_ARTICLES_SUMMARY.md
-rw-rw-rw-    1 vscode vscode 10732 Feb 10 02:08 SUPERADMIN_ARTICLES_TESTS.md
-rw-rw-rw-    1 vscode vscode 16079 Feb 10 02:08 SUPERADMIN_ARTICLES_UI.md
-rw-rw-rw-    1 vscode vscode 18298 Feb 10 02:08 SYSTEM_ARCHITECTURE_VISUAL.md
-rw-rw-rw-    1 vscode vscode 11111 Feb 10 02:08 SYSTEM_READY_TO_DEPLOY.md
-rw-rw-rw-    1 vscode vscode  5974 Feb 10 02:08 TASK_SUMMARY.md
-rw-r--r--    1 vscode vscode  3073 Feb 10 02:08 tates"
-rw-r--r--    1 vscode vscode  8192 Feb 10 02:08 tatus
-rw-r--r--    1 vscode vscode 18923 Feb 10 02:08 te du diff
-rw-rw-rw-    1 vscode vscode  8503 Feb 10 02:07 TEST_AJOUT_ARTICLE_COMPLET.md
-rw-rw-rw-    1 vscode vscode 10926 Feb 10 02:08 TESTING_GROUP_MAP_VISIBILITY.md
-rw-rw-rw-    1 vscode vscode 11703 Feb 10 02:08 TESTS_ARTICLES_PHOTO_GUIDE.md
-rw-rw-rw-    1 vscode vscode  3492 Feb 10 02:08 TROUBLESHOOTING_IMPORTS.md
-rw-rw-rw-    1 vscode vscode  3667 Feb 10 02:07 UNLOCK_GITHUB_PUSH.md
-rw-rw-rw-    1 vscode vscode  1602 Feb 10 02:08 UNLOCK_NOW.txt
-rw-rw-rw-    1 vscode vscode  1298 Feb 10 02:08 update_v3_branch.sh
-rw-rw-rw-    1 vscode vscode  4572 Feb 10 02:08 V21_DEPLOYMENT.md
-rw-rw-rw-    1 vscode vscode  1736 Feb 10 02:08 validate_and_commit.sh
-rw-rw-rw-    1 vscode vscode  5635 Feb 10 02:08 VALIDATION_AND_DEPLOYMENT.md
-rw-rw-rw-    1 vscode vscode   850 Feb 10 02:08 verify_files.sh
-rw-rw-rw-    1 vscode vscode  2973 Feb 10 02:07 verify_mapbox_fixes.sh
-rw-rw-rw-    1 vscode vscode 10408 Feb 10 02:08 VISUAL_SUMMARY.md
drwxrwxrwx+   2 vscode vscode  4096 Feb 11 13:47 .vscode
-rw-rw-rw-    1 vscode vscode 18562 Feb 10 02:08 WIZARD_CIRCUIT_RAPPORT.md
-rw-rw-rw-    1 vscode vscode  2310 Feb 10 02:07 WIZARD_IMPROVEMENTS_SUMMARY.md
-rw-rw-rw-    1 vscode vscode  5654 Feb 10 02:07 WIZARD_UX_IMPROVEMENTS.md

## 2) Arborescence Flutter: app/lib (dossiers profondeur 3)

 - app/lib
 - app/lib/constants
 - app/lib/widgets
 - app/lib/widgets/commerce
 - app/lib/sections
 - app/lib/examples
 - app/lib/session
 - app/lib/models
 - app/lib/tests
 - app/lib/shop
 - app/lib/shop/widgets
 - app/lib/theme
 - app/lib/l10n
 - app/lib/ui
 - app/lib/ui/widgets
 - app/lib/ui/theme
 - app/lib/ui/wizard
 - app/lib/ui/map
 - app/lib/scripts
 - app/lib/profile
 - app/lib/services
 - app/lib/services/commerce
 - app/lib/services/group
 - app/lib/utils
 - app/lib/pages
 - app/lib/pages/commerce
 - app/lib/pages/shop
 - app/lib/pages/checkout
 - app/lib/pages/legacy_stubs
 - app/lib/pages/auth
 - app/lib/pages/group
 - app/lib/pages/admin
 - app/lib/admin
 - app/lib/admin/assistant_step_by_step

## 3) Arborescence Functions (dossiers profondeur 3)

 - functions
 - functions/node_modules
 - functions/node_modules/accepts
 - functions/node_modules/color-name
 - functions/node_modules/http-errors
 - functions/node_modules/jose
 - functions/node_modules/jose/dist
 - functions/node_modules/mime
 - functions/node_modules/mime/types
 - functions/node_modules/fast-xml-parser
 - functions/node_modules/fast-xml-parser/src
 - functions/node_modules/jws
 - functions/node_modules/jws/lib
 - functions/node_modules/es-set-tostringtag
 - functions/node_modules/es-set-tostringtag/test
 - functions/node_modules/@types
 - functions/node_modules/@types/http-errors
 - functions/node_modules/@types/mime
 - functions/node_modules/@types/body-parser
 - functions/node_modules/@types/qs
 - functions/node_modules/@types/cors
 - functions/node_modules/@types/express-serve-static-core
 - functions/node_modules/@types/tough-cookie
 - functions/node_modules/@types/range-parser
 - functions/node_modules/@types/jsonwebtoken
 - functions/node_modules/@types/ms
 - functions/node_modules/@types/express
 - functions/node_modules/@types/send
 - functions/node_modules/@types/request
 - functions/node_modules/@types/connect
 - functions/node_modules/@types/long
 - functions/node_modules/@types/serve-static
 - functions/node_modules/@types/node
 - functions/node_modules/@types/caseless
 - functions/node_modules/utils-merge
 - functions/node_modules/methods
 - functions/node_modules/@fastify
 - functions/node_modules/@fastify/busboy
 - functions/node_modules/etag
 - functions/node_modules/math-intrinsics
 - functions/node_modules/math-intrinsics/constants
 - functions/node_modules/math-intrinsics/.github
 - functions/node_modules/math-intrinsics/test
 - functions/node_modules/combined-stream
 - functions/node_modules/combined-stream/lib
 - functions/node_modules/es-define-property
 - functions/node_modules/es-define-property/.github
 - functions/node_modules/es-define-property/test
 - functions/node_modules/media-typer
 - functions/node_modules/lodash.once
 - functions/node_modules/es-errors
 - functions/node_modules/es-errors/.github
 - functions/node_modules/es-errors/test
 - functions/node_modules/get-intrinsic
 - functions/node_modules/get-intrinsic/.github
 - functions/node_modules/get-intrinsic/test
 - functions/node_modules/setprototypeof
 - functions/node_modules/setprototypeof/test
 - functions/node_modules/lodash.isboolean
 - functions/node_modules/ipaddr.js
 - functions/node_modules/ipaddr.js/lib
 - functions/node_modules/wrap-ansi
 - functions/node_modules/side-channel
 - functions/node_modules/side-channel/.github
 - functions/node_modules/side-channel/test
 - functions/node_modules/cliui
 - functions/node_modules/cliui/build
 - functions/node_modules/require-directory
 - functions/node_modules/body-parser
 - functions/node_modules/body-parser/lib
 - functions/node_modules/buffer-equal-constant-time
 - functions/node_modules/proxy-addr
 - functions/node_modules/ngeohash
 - functions/node_modules/ngeohash/tests
 - functions/node_modules/ansi-regex
 - functions/node_modules/readable-stream
 - functions/node_modules/readable-stream/lib
 - functions/node_modules/duplexify
 - functions/node_modules/qs
 - functions/node_modules/qs/dist
 - functions/node_modules/qs/.github
 - functions/node_modules/qs/test
 - functions/node_modules/qs/lib
 - functions/node_modules/async-retry
 - functions/node_modules/async-retry/lib
 - functions/node_modules/escape-html
 - functions/node_modules/node-forge
 - functions/node_modules/node-forge/dist
 - functions/node_modules/node-forge/lib
 - functions/node_modules/node-forge/flash
 - functions/node_modules/websocket-extensions
 - functions/node_modules/websocket-extensions/lib
 - functions/node_modules/side-channel-list
 - functions/node_modules/side-channel-list/.github
 - functions/node_modules/side-channel-list/test
 - functions/node_modules/extend
 - functions/node_modules/@firebase
 - functions/node_modules/@firebase/database
 - functions/node_modules/@firebase/component
 - functions/node_modules/@firebase/util
 - functions/node_modules/@firebase/logger
 - functions/node_modules/@firebase/auth-interop-types
 - functions/node_modules/@firebase/database-compat
 - functions/node_modules/@firebase/database-types
 - functions/node_modules/@firebase/app-check-interop-types
 - functions/node_modules/@firebase/app-types
 - functions/node_modules/cors
 - functions/node_modules/cors/lib
 - functions/node_modules/once
 - functions/node_modules/raw-body
 - functions/node_modules/object-hash
 - functions/node_modules/object-hash/dist
 - functions/node_modules/@google-cloud
 - functions/node_modules/@google-cloud/storage
 - functions/node_modules/@google-cloud/firestore
 - functions/node_modules/@google-cloud/projectify
 - functions/node_modules/@google-cloud/promisify
 - functions/node_modules/@google-cloud/paginator
 - functions/node_modules/limiter
 - functions/node_modules/limiter/test
 - functions/node_modules/limiter/lib
 - functions/node_modules/yargs
 - functions/node_modules/yargs/lib
 - functions/node_modules/yargs/helpers
 - functions/node_modules/yargs/locales
 - functions/node_modules/yargs/build
 - functions/node_modules/forwarded
 - functions/node_modules/jwa
 - functions/node_modules/unpipe
 - functions/node_modules/tr46
 - functions/node_modules/tr46/lib
 - functions/node_modules/encodeurl
 - functions/node_modules/statuses
 - functions/node_modules/depd
 - functions/node_modules/depd/lib
 - functions/node_modules/has-tostringtag
 - functions/node_modules/has-tostringtag/.github
 - functions/node_modules/has-tostringtag/test
 - functions/node_modules/lodash.clonedeep
 - functions/node_modules/webidl-conversions
 - functions/node_modules/webidl-conversions/lib
 - functions/node_modules/gopd
 - functions/node_modules/gopd/.github
 - functions/node_modules/gopd/test
 - functions/node_modules/fast-deep-equal
 - functions/node_modules/fast-deep-equal/es6
 - functions/node_modules/@opentelemetry
 - functions/node_modules/@opentelemetry/api
 - functions/node_modules/yargs-parser
 - functions/node_modules/yargs-parser/build
 - functions/node_modules/farmhash-modern
 - functions/node_modules/farmhash-modern/lib
 - functions/node_modules/farmhash-modern/bin
 - functions/node_modules/gaxios
 - functions/node_modules/gaxios/node_modules
 - functions/node_modules/gaxios/build
 - functions/node_modules/semver
 - functions/node_modules/semver/functions
 - functions/node_modules/semver/bin
 - functions/node_modules/semver/classes
 - functions/node_modules/semver/ranges
 - functions/node_modules/semver/internal
 - functions/node_modules/lru-memoizer
 - functions/node_modules/lru-memoizer/test
 - functions/node_modules/lru-memoizer/lib
 - functions/node_modules/teeny-request
 - functions/node_modules/teeny-request/node_modules
 - functions/node_modules/teeny-request/build
 - functions/node_modules/faye-websocket
 - functions/node_modules/faye-websocket/lib
 - functions/node_modules/has-symbols
 - functions/node_modules/has-symbols/.github
 - functions/node_modules/has-symbols/test
 - functions/node_modules/array-flatten
 - functions/node_modules/on-finished
 - functions/node_modules/ecdsa-sig-formatter
 - functions/node_modules/ecdsa-sig-formatter/src
 - functions/node_modules/bytes
 - functions/node_modules/asynckit
 - functions/node_modules/asynckit/lib
 - functions/node_modules/string_decoder
 - functions/node_modules/string_decoder/lib
 - functions/node_modules/side-channel-weakmap
 - functions/node_modules/side-channel-weakmap/.github
 - functions/node_modules/side-channel-weakmap/test
 - functions/node_modules/delayed-stream
 - functions/node_modules/delayed-stream/lib
 - functions/node_modules/string-width
 - functions/node_modules/ansi-styles
 - functions/node_modules/bignumber.js
 - functions/node_modules/bignumber.js/doc
 - functions/node_modules/google-gax
 - functions/node_modules/google-gax/node_modules
 - functions/node_modules/google-gax/build
 - functions/node_modules/http-parser-js
 - functions/node_modules/cookie-signature
 - functions/node_modules/type-is
 - functions/node_modules/proto3-json-serializer
 - functions/node_modules/proto3-json-serializer/build
 - functions/node_modules/path-to-regexp
 - functions/node_modules/range-parser
 - functions/node_modules/strip-ansi
 - functions/node_modules/node-fetch
 - functions/node_modules/node-fetch/lib
 - functions/node_modules/stubs
 - functions/node_modules/agent-base
 - functions/node_modules/agent-base/dist
 - functions/node_modules/google-auth-library
 - functions/node_modules/google-auth-library/build
 - functions/node_modules/ee-first
 - functions/node_modules/stream-events
 - functions/node_modules/jsonwebtoken
 - functions/node_modules/jsonwebtoken/node_modules
 - functions/node_modules/jsonwebtoken/lib
 - functions/node_modules/emoji-regex
 - functions/node_modules/emoji-regex/es2015
 - functions/node_modules/ms
 - functions/node_modules/safe-buffer
 - functions/node_modules/hasown
 - functions/node_modules/hasown/.github
 - functions/node_modules/call-bound
 - functions/node_modules/call-bound/.github
 - functions/node_modules/call-bound/test
 - functions/node_modules/color-convert
 - functions/node_modules/object-assign
 - functions/node_modules/get-caller-file
 - functions/node_modules/inherits
 - functions/node_modules/object-inspect
 - functions/node_modules/object-inspect/.github
 - functions/node_modules/object-inspect/test
 - functions/node_modules/object-inspect/example
 - functions/node_modules/@protobufjs
 - functions/node_modules/@protobufjs/aspromise
 - functions/node_modules/@protobufjs/float
 - functions/node_modules/@protobufjs/codegen
 - functions/node_modules/@protobufjs/fetch
 - functions/node_modules/@protobufjs/eventemitter
 - functions/node_modules/@protobufjs/base64
 - functions/node_modules/@protobufjs/utf8
 - functions/node_modules/@protobufjs/pool
 - functions/node_modules/@protobufjs/path
 - functions/node_modules/@protobufjs/inquire
 - functions/node_modules/escalade
 - functions/node_modules/escalade/dist
 - functions/node_modules/escalade/sync
 - functions/node_modules/express
 - functions/node_modules/express/lib
 - functions/node_modules/function-bind
 - functions/node_modules/function-bind/.github
 - functions/node_modules/function-bind/test
 - functions/node_modules/strnum
 - functions/node_modules/strnum/.vscode
 - functions/node_modules/https-proxy-agent
 - functions/node_modules/https-proxy-agent/dist
 - functions/node_modules/https-proxy-agent/node_modules
 - functions/node_modules/cookie
 - functions/node_modules/gcp-metadata
 - functions/node_modules/gcp-metadata/build
 - functions/node_modules/lodash.camelcase
 - functions/node_modules/content-disposition
 - functions/node_modules/lodash.isinteger
 - functions/node_modules/yocto-queue
 - functions/node_modules/send
 - functions/node_modules/send/node_modules
 - functions/node_modules/fresh
 - functions/node_modules/debug
 - functions/node_modules/debug/src
 - functions/node_modules/retry-request
 - functions/node_modules/es-object-atoms
 - functions/node_modules/es-object-atoms/.github
 - functions/node_modules/es-object-atoms/test
 - functions/node_modules/undici-types
 - functions/node_modules/google-logging-utils
 - functions/node_modules/google-logging-utils/build
 - functions/node_modules/end-of-stream
 - functions/node_modules/@js-sdsl
 - functions/node_modules/@js-sdsl/ordered-map
 - functions/node_modules/merge-descriptors
 - functions/node_modules/@grpc
 - functions/node_modules/@grpc/proto-loader
 - functions/node_modules/@grpc/grpc-js
 - functions/node_modules/retry
 - functions/node_modules/retry/lib
 - functions/node_modules/retry/example
 - functions/node_modules/stream-shift
 - functions/node_modules/stream-shift/.github
 - functions/node_modules/finalhandler
 - functions/node_modules/negotiator
 - functions/node_modules/negotiator/lib
 - functions/node_modules/get-proto
 - functions/node_modules/get-proto/.github
 - functions/node_modules/get-proto/test
 - functions/node_modules/abort-controller
 - functions/node_modules/abort-controller/dist
 - functions/node_modules/websocket-driver
 - functions/node_modules/websocket-driver/lib
 - functions/node_modules/form-data
 - functions/node_modules/form-data/lib
 - functions/node_modules/destroy
 - functions/node_modules/gtoken
 - functions/node_modules/gtoken/build
 - functions/node_modules/@tootallnate
 - functions/node_modules/@tootallnate/once
 - functions/node_modules/toidentifier
 - functions/node_modules/whatwg-url
 - functions/node_modules/whatwg-url/lib
 - functions/node_modules/util-deprecate
 - functions/node_modules/vary
 - functions/node_modules/lodash.isstring
 - functions/node_modules/uuid
 - functions/node_modules/uuid/dist
 - functions/node_modules/safer-buffer
 - functions/node_modules/long
 - functions/node_modules/long/umd
 - functions/node_modules/serve-static
 - functions/node_modules/call-bind-apply-helpers
 - functions/node_modules/call-bind-apply-helpers/.github
 - functions/node_modules/call-bind-apply-helpers/test
 - functions/node_modules/firebase-admin
 - functions/node_modules/firebase-admin/lib
 - functions/node_modules/lodash.isnumber
 - functions/node_modules/mime-db
 - functions/node_modules/is-fullwidth-code-point
 - functions/node_modules/yallist
 - functions/node_modules/tslib
 - functions/node_modules/tslib/modules
 - functions/node_modules/lodash.isplainobject
 - functions/node_modules/wrappy
 - functions/node_modules/base64-js
 - functions/node_modules/.bin
 - functions/node_modules/jwks-rsa
 - functions/node_modules/jwks-rsa/node_modules
 - functions/node_modules/jwks-rsa/src
 - functions/node_modules/parseurl
 - functions/node_modules/content-type
 - functions/node_modules/lodash.includes
 - functions/node_modules/html-entities
 - functions/node_modules/html-entities/dist
 - functions/node_modules/html-entities/src
 - functions/node_modules/firebase-functions
 - functions/node_modules/firebase-functions/.guides
 - functions/node_modules/firebase-functions/lib
 - functions/node_modules/firebase-functions/protos
 - functions/node_modules/json-bigint
 - functions/node_modules/json-bigint/lib
 - functions/node_modules/mime-types
 - functions/node_modules/stripe
 - functions/node_modules/stripe/types
 - functions/node_modules/stripe/cjs
 - functions/node_modules/stripe/esm
 - functions/node_modules/arrify
 - functions/node_modules/event-target-shim
 - functions/node_modules/event-target-shim/dist
 - functions/node_modules/side-channel-map
 - functions/node_modules/side-channel-map/.github
 - functions/node_modules/side-channel-map/test
 - functions/node_modules/functional-red-black-tree
 - functions/node_modules/functional-red-black-tree/test
 - functions/node_modules/functional-red-black-tree/bench
 - functions/node_modules/http-proxy-agent
 - functions/node_modules/http-proxy-agent/dist
 - functions/node_modules/http-proxy-agent/node_modules
 - functions/node_modules/protobufjs
 - functions/node_modules/protobufjs/dist
 - functions/node_modules/protobufjs/ext
 - functions/node_modules/protobufjs/scripts
 - functions/node_modules/protobufjs/google
 - functions/node_modules/protobufjs/src
 - functions/node_modules/y18n
 - functions/node_modules/y18n/build
 - functions/node_modules/dunder-proto
 - functions/node_modules/dunder-proto/.github
 - functions/node_modules/dunder-proto/test
 - functions/node_modules/p-limit
 - functions/node_modules/iconv-lite
 - functions/node_modules/iconv-lite/lib
 - functions/node_modules/iconv-lite/encodings
 - functions/node_modules/is-stream
 - functions/node_modules/lru-cache
 - functions/scripts
 - functions/src

## 4) Recherche cibl√©e (services/pages/menu/routes/roles/firestore)

### 4.1 ProductService / StorageService

app/lib/admin/admin_products_page.dart:  final _storageService = StorageService.instance;
app/lib/admin/admin_products_page.dart:  /// ‚úÖ Utilise StorageService avec structure organis√©e: products/{shopId}/{productId}/original/0.jpg
app/lib/admin/admin_products_page.dart:      // Upload via StorageService avec structure organis√©e
app/lib/tests/article_test_helper.dart:  final StorageService _storage = StorageService.instance;
app/lib/pages/superadmin_articles_page.dart:  final StorageService _storageService = StorageService.instance;
app/lib/examples/article_upload_asset_smoke_test.dart:  final _storage = StorageService.instance;
app/lib/pages/group_add_item_page.dart:  final _storageService = StorageService.instance;
app/lib/pages/group_add_item_page.dart:      // Upload Storage via StorageService (structure: groups/{groupId}/products/{productId}/original/1.jpg)
app/lib/pages/group_add_item_page.dart:      // On convertit Uint8List en XFile pour utiliser StorageService
app/lib/services/commerce/commerce_service.dart:  final StorageService _storageService = StorageService.instance;
app/lib/services/commerce/commerce_service.dart:  /// ‚úÖ Utilise maintenant StorageService avec structure organis√©e
app/lib/services/commerce/commerce_service.dart:    // Convertit File en XFile pour utiliser StorageService
app/lib/services/commerce/commerce_service.dart:  /// ‚úÖ Utilise maintenant StorageService avec structure organis√©e
app/lib/services/group/group_shop_service.dart:// ‚úÖ Utilise maintenant StorageService centralis√©
app/lib/services/group/group_shop_service.dart:  final StorageService _storageService = StorageService.instance;
app/lib/services/group/group_shop_service.dart:  // ‚úÖ Upload via StorageService avec structure organis√©e: groups/{groupId}/products/{productId}
app/lib/services/group/group_shop_service.dart:    // Upload photos via StorageService
app/lib/services/group/group_shop_service.dart:  // ‚úÖ Utilise StorageService pour supprimer les photos
app/lib/services/group/group_shop_service.dart:    // Supprime le dossier Storage via StorageService
app/lib/services/group/group_shop_service.dart:  // ‚úÖ Upload via StorageService avec structure: groups/{groupId}/media/{mediaId}
app/lib/services/group/group_shop_service.dart:    // Upload via StorageService (utilise structure groups/{groupId}/media/{mediaId}/original/)
app/lib/services/group/group_shop_service.dart:    // Note: createMedia n'est pas sp√©cifique aux groupes dans StorageService,
app/lib/services/storage_service.dart:class StorageService {
app/lib/services/storage_service.dart:  static final StorageService instance = StorageService._internal();
app/lib/services/storage_service.dart:  StorageService._internal();
app/lib/services/storage_service.dart:    developer.log('üì¶ [StorageService] Upload depuis asset: $assetPath');
app/lib/services/storage_service.dart:      developer.log('‚ùå [StorageService] User non authentifi√©');
app/lib/services/storage_service.dart:      developer.log('‚úÖ [StorageService] Asset charg√©: ${bytes.length} bytes');
app/lib/services/storage_service.dart:      developer.log('üîß [StorageService] Upload asset vers: $path');
app/lib/services/storage_service.dart:      developer.log('‚úÖ [StorageService] Asset upload√©: $downloadUrl');
app/lib/services/storage_service.dart:      developer.log('‚ùå [StorageService] Erreur upload asset: $e');
app/lib/services/storage_service.dart:    developer.log('üîß [StorageService] D√©but upload: $path');
app/lib/services/storage_service.dart:      developer.log('‚ùå [StorageService] User non authentifi√©');
app/lib/services/storage_service.dart:    developer.log('‚úÖ [StorageService] User authentifi√©: ${user.uid}');
app/lib/services/storage_service.dart:    developer.log('‚úÖ [StorageService] R√©f√©rence Storage cr√©√©e: $path');
app/lib/services/storage_service.dart:    developer.log('‚úÖ [StorageService] M√©tadonn√©es cr√©√©es');
app/lib/services/storage_service.dart:        developer.log('üåê [StorageService] Mode WEB - lecture bytes...');
app/lib/services/storage_service.dart:        developer.log('üì± [StorageService] Mode MOBILE - lecture bytes...');
app/lib/services/storage_service.dart:      developer.log('‚úÖ [StorageService] ${bytes.length} bytes lus');
app/lib/services/storage_service.dart:      developer.log('‚úÖ [StorageService] UploadTask cr√©√©e');
app/lib/services/storage_service.dart:      developer.log('‚è≥ [StorageService] Attente fin upload...');
app/lib/services/storage_service.dart:      developer.log('‚úÖ [StorageService] Upload termin√©');
app/lib/services/storage_service.dart:      developer.log('‚úÖ [StorageService] URL r√©cup√©r√©e: $downloadUrl');
app/lib/services/storage_service.dart:      developer.log('‚ùå [StorageService] Erreur upload: $e');

### 4.2 Add Product / Admin Profile / Dashboard

app/lib/admin/admin_system_settings_page.dart:class AdminSystemSettingsPage extends StatefulWidget {
app/lib/admin/admin_system_settings_page.dart:  const AdminSystemSettingsPage({super.key});
app/lib/admin/admin_system_settings_page.dart:  State<AdminSystemSettingsPage> createState() => _AdminSystemSettingsPageState();
app/lib/admin/admin_system_settings_page.dart:class _AdminSystemSettingsPageState extends State<AdminSystemSettingsPage> {
app/lib/admin/admin_orders_page.dart:class AdminOrdersPage extends StatefulWidget {
app/lib/admin/admin_orders_page.dart:  const AdminOrdersPage({super.key});
app/lib/admin/admin_orders_page.dart:  State<AdminOrdersPage> createState() => _AdminOrdersPageState();
app/lib/admin/admin_orders_page.dart:class _AdminOrdersPageState extends State<AdminOrdersPage> {
app/lib/admin/admin_pois_simple_page.dart:class AdminPOIsSimplePage extends StatefulWidget {
app/lib/admin/admin_pois_simple_page.dart:  const AdminPOIsSimplePage({super.key});
app/lib/admin/admin_pois_simple_page.dart:  State<AdminPOIsSimplePage> createState() => _AdminPOIsSimplePageState();
app/lib/admin/admin_pois_simple_page.dart:class _AdminPOIsSimplePageState extends State<AdminPOIsSimplePage> {
app/lib/admin/admin_main_dashboard.dart:// Dashboard admin principal 10/10 avec toutes les fonctionnalit√©s premium
app/lib/admin/admin_main_dashboard.dart:/// Dashboard admin principal 10/10 avec toutes les fonctionnalit√©s
app/lib/admin/admin_main_dashboard.dart:class AdminMainDashboard extends StatefulWidget {
app/lib/admin/admin_main_dashboard.dart:  const AdminMainDashboard({super.key});
app/lib/admin/admin_main_dashboard.dart:  State<AdminMainDashboard> createState() => _AdminMainDashboardState();
app/lib/admin/admin_main_dashboard.dart:class _AdminMainDashboardState extends State<AdminMainDashboard> {
app/lib/admin/admin_main_dashboard.dart:  Stream<int> _watchPendingCommerceSubmissionsCount() {
app/lib/admin/admin_main_dashboard.dart:            _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                            const AdminAssistantStepByStepHomePage(),
app/lib/admin/admin_main_dashboard.dart:            _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:            _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                        builder: (_) => const AdminTrackingPage(),
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:            // Section Commerce
app/lib/admin/admin_main_dashboard.dart:            _buildSectionTitle('Commerce', Icons.shopping_bag),
app/lib/admin/admin_main_dashboard.dart:                      return _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                        builder: (_) => const AdminOrdersPage(),
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                    stream: _watchPendingCommerceSubmissionsCount(),
app/lib/admin/admin_main_dashboard.dart:                      return _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                            builder: (_) => const AdminModerationPage(),
app/lib/admin/admin_main_dashboard.dart:                      return _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                    title: 'Mod√©ration Commerce',
app/lib/admin/admin_main_dashboard.dart:                        builder: (_) => const AdminModerationPage(),
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                    title: 'Analytics Commerce',
app/lib/admin/admin_main_dashboard.dart:                        builder: (_) => const CommerceAnalyticsPage(),
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                          return _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:            _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:            _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:            _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                        builder: (_) => const AdminAnalyticsPage(),
app/lib/admin/admin_main_dashboard.dart:                  child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(builder: (_) => const AdminLogsPage()),
app/lib/admin/admin_main_dashboard.dart:              _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                    builder: (_) => const AdminSystemSettingsPage(),
app/lib/admin/admin_main_dashboard.dart:                    child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                    child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                    child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:                    child: _buildDashboardCard(
app/lib/admin/admin_main_dashboard.dart:      MaterialPageRoute(builder: (_) => const AdminStockPage(shopId: 'global')),
app/lib/admin/admin_main_dashboard.dart:      MaterialPageRoute(builder: (_) => const AdminProductCategoriesPage()),
app/lib/admin/admin_main_dashboard.dart:  Widget _buildDashboardCard({
app/lib/admin/admin_main_dashboard.dart:class AdminAssistantStepByStepHomePage extends StatelessWidget {
app/lib/admin/admin_main_dashboard.dart:  const AdminAssistantStepByStepHomePage({super.key});
app/lib/admin/admin_tracking_page.dart:/// AdminTrackingPage - Version MasLiveMap (Phase 2)
app/lib/admin/admin_tracking_page.dart:class AdminTrackingPage extends StatefulWidget {
app/lib/admin/admin_tracking_page.dart:  const AdminTrackingPage({super.key});
app/lib/admin/admin_tracking_page.dart:  State<AdminTrackingPage> createState() => _AdminTrackingPageState();
app/lib/admin/admin_tracking_page.dart:class _AdminTrackingPageState extends State<AdminTrackingPage> {
app/lib/admin/admin_product_categories_page.dart:class AdminProductCategoriesPage extends StatefulWidget {
app/lib/admin/admin_product_categories_page.dart:  const AdminProductCategoriesPage({super.key});
app/lib/admin/admin_product_categories_page.dart:  State<AdminProductCategoriesPage> createState() =>
app/lib/admin/admin_product_categories_page.dart:      _AdminProductCategoriesPageState();
app/lib/admin/admin_product_categories_page.dart:class _AdminProductCategoriesPageState
app/lib/admin/admin_product_categories_page.dart:    extends State<AdminProductCategoriesPage> {
app/lib/admin/admin_moderation_page.dart:class AdminModerationPage extends StatefulWidget {
app/lib/admin/admin_moderation_page.dart:  const AdminModerationPage({super.key});
app/lib/admin/admin_moderation_page.dart:  State<AdminModerationPage> createState() => _AdminModerationPageState();
app/lib/admin/admin_moderation_page.dart:class _AdminModerationPageState extends State<AdminModerationPage> {
app/lib/admin/admin_moderation_page.dart:  final _service = CommerceService.instance;
app/lib/admin/admin_moderation_page.dart:        title: const Text('Mod√©ration Commerce', style: TextStyle(color: Colors.black87, fontWeight: FontWeight.bold)),
app/lib/admin/admin_moderation_page.dart:      body: StreamBuilder<List<CommerceSubmission>>(
app/lib/admin/admin_moderation_page.dart:  Future<void> _approve(CommerceSubmission submission) async {
app/lib/admin/admin_moderation_page.dart:  Future<void> _reject(CommerceSubmission submission) async {
app/lib/admin/user_profile_preview_page.dart:          'title': 'Mon Commerce',
app/lib/admin/user_profile_preview_page.dart:          'title': 'Dashboard Admin',
app/lib/admin/user_profile_preview_page.dart:          {'label': 'Dashboard administration', 'granted': true},
app/lib/admin/user_profile_preview_page.dart:          'Dashboard analytics',
app/lib/admin/admin_tracking_page_v2.dart:/// AdminTrackingPage - Version MasLiveMap (Phase 2)
app/lib/admin/admin_tracking_page_v2.dart:class AdminTrackingPage extends StatefulWidget {
app/lib/admin/admin_tracking_page_v2.dart:  const AdminTrackingPage({super.key});
app/lib/admin/admin_tracking_page_v2.dart:  State<AdminTrackingPage> createState() => _AdminTrackingPageState();
app/lib/admin/admin_tracking_page_v2.dart:class _AdminTrackingPageState extends State<AdminTrackingPage> {
app/lib/admin/create_product_dialog.dart:        // compat UI actuelle (AdminProductsPage utilise imageUrl)
app/lib/admin/create_product_dialog.dart:      // Source de v√©rit√©: collection racine `products` (utilis√©e par AdminStockPage, etc.)
app/lib/admin/admin_products_page.dart:class AdminProductsPage extends StatefulWidget {
app/lib/admin/admin_products_page.dart:  const AdminProductsPage({super.key, this.shopId = 'global'});
app/lib/admin/admin_products_page.dart:  State<AdminProductsPage> createState() => _AdminProductsPageState();
app/lib/admin/admin_products_page.dart:class _AdminProductsPageState extends State<AdminProductsPage> {
app/lib/admin/admin_stock_page.dart:class AdminStockPage extends StatefulWidget {
app/lib/admin/admin_stock_page.dart:  const AdminStockPage({super.key, this.shopId});
app/lib/admin/admin_stock_page.dart:  State<AdminStockPage> createState() => _AdminStockPageState();
app/lib/admin/admin_stock_page.dart:class _AdminStockPageState extends State<AdminStockPage> {
app/lib/admin/poi_assistant_page.dart:      'name': 'Martinique - Commerce',
app/lib/admin/admin_analytics_page.dart:class AdminAnalyticsPage extends StatefulWidget {
app/lib/admin/admin_analytics_page.dart:  const AdminAnalyticsPage({super.key});
app/lib/admin/admin_analytics_page.dart:  State<AdminAnalyticsPage> createState() => _AdminAnalyticsPageState();
app/lib/admin/admin_analytics_page.dart:class _AdminAnalyticsPageState extends State<AdminAnalyticsPage> {
app/lib/admin/commerce_analytics_page.dart:/// Dashboard analytics commerce avec CA, conversions, stats
app/lib/admin/commerce_analytics_page.dart:class CommerceAnalyticsPage extends StatefulWidget {
app/lib/admin/commerce_analytics_page.dart:  const CommerceAnalyticsPage({super.key});
app/lib/admin/commerce_analytics_page.dart:  State<CommerceAnalyticsPage> createState() => _CommerceAnalyticsPageState();
app/lib/admin/commerce_analytics_page.dart:class _CommerceAnalyticsPageState extends State<CommerceAnalyticsPage> {
app/lib/admin/commerce_analytics_page.dart:          'Analytics Commerce',
app/lib/admin/admin_pois_page_deprecated.dart:/// Page obsol√®te - Utiliser AdminPOIsSimplePage
app/lib/admin/admin_pois_page_deprecated.dart:@Deprecated('Utiliser AdminPOIsSimplePage √† la place')
app/lib/admin/admin_pois_page_deprecated.dart:class AdminPOIsPageDeprecated extends StatelessWidget {
app/lib/admin/admin_pois_page_deprecated.dart:  const AdminPOIsPageDeprecated({super.key});
app/lib/admin/admin_pois_page_deprecated.dart:            Text('Utilisez AdminPOIsSimplePage √† la place'),
app/lib/admin/admin_logs_page.dart:class AdminLogsPage extends StatefulWidget {
app/lib/admin/admin_logs_page.dart:  const AdminLogsPage({super.key});
app/lib/admin/admin_logs_page.dart:  State<AdminLogsPage> createState() => _AdminLogsPageState();
app/lib/admin/admin_logs_page.dart:class _AdminLogsPageState extends State<AdminLogsPage> with SingleTickerProviderStateMixin {
app/lib/admin/admin_circuits_page.dart:class AdminCircuitsPage extends StatefulWidget {
app/lib/admin/admin_circuits_page.dart:  const AdminCircuitsPage({super.key});
app/lib/admin/admin_circuits_page.dart:  State<AdminCircuitsPage> createState() => _AdminCircuitsPageState();
app/lib/admin/admin_circuits_page.dart:class _AdminCircuitsPageState extends State<AdminCircuitsPage> {
app/lib/admin/admin_dashboard_page.dart:class AdminStatsDashboardPage extends StatefulWidget {
app/lib/admin/admin_dashboard_page.dart:  const AdminStatsDashboardPage({super.key});
app/lib/admin/admin_dashboard_page.dart:  State<AdminStatsDashboardPage> createState() => _AdminStatsDashboardPageState();
app/lib/admin/admin_dashboard_page.dart:class _AdminStatsDashboardPageState extends State<AdminStatsDashboardPage> {
app/lib/admin/admin_dashboard_page.dart:    _loadDashboardData();
app/lib/admin/admin_dashboard_page.dart:  Future<void> _loadDashboardData() async {
app/lib/admin/admin_dashboard_page.dart:        title: const Text('Tableau de bord Admin'),
app/lib/admin/admin_dashboard_page.dart:            onPressed: _loadDashboardData,
app/lib/admin/admin_dashboard_page.dart:              onRefresh: _loadDashboardData,
app/lib/admin/admin_dashboard_page.dart:                      builder: (context) => const AdminAnalyticsPage(),
app/lib/admin/admin_dashboard_page.dart:                      builder: (context) => const AdminLogsPage(),
app/lib/admin/admin_dashboard_page.dart:                        builder: (context) => const AdminSystemSettingsPage(),
app/lib/services/localization_service.dart:      'admin_title': 'Tableau de bord Admin',
app/lib/services/localization_service.dart:      'admin_title': 'Admin Dashboard',
app/lib/services/group/group_average_service.dart:      final admin = GroupAdmin.fromFirestore(snapshot.docs.first);
app/lib/services/group/group_link_service.dart:  Future<GroupAdmin> createAdminProfile({
app/lib/services/group/group_link_service.dart:    final admin = GroupAdmin(
app/lib/services/group/group_link_service.dart:    final adminCode = GroupAdminCode(
app/lib/services/group/group_link_service.dart:  Future<GroupAdminCode?> validateAdminCode(String code) async {
app/lib/services/group/group_link_service.dart:    final adminCode = GroupAdminCode.fromFirestore(doc);
app/lib/services/group/group_link_service.dart:  Future<GroupAdmin?> getAdminProfile(String uid) async {
app/lib/services/group/group_link_service.dart:    return GroupAdmin.fromFirestore(doc);
app/lib/services/group/group_link_service.dart:  Stream<GroupAdmin?> streamAdminProfile(String uid) {
app/lib/services/group/group_link_service.dart:        .map((doc) => doc.exists ? GroupAdmin.fromFirestore(doc) : null);
app/lib/pages/admin/admin_moderation_page.dart:class AdminModerationPage extends StatefulWidget {
app/lib/pages/admin/admin_moderation_page.dart:  const AdminModerationPage({super.key});
app/lib/pages/admin/admin_moderation_page.dart:  State<AdminModerationPage> createState() => _AdminModerationPageState();
app/lib/pages/admin/admin_moderation_page.dart:class _AdminModerationPageState extends State<AdminModerationPage> {
app/lib/pages/admin/admin_moderation_page.dart:  final _service = CommerceService.instance;
app/lib/pages/admin/admin_moderation_page.dart:        title: const Text('Mod√©ration Commerce', style: TextStyle(color: Colors.black87, fontWeight: FontWeight.bold)),
app/lib/pages/admin/admin_moderation_page.dart:      body: StreamBuilder<List<CommerceSubmission>>(
app/lib/pages/admin/admin_moderation_page.dart:  Future<void> _approve(CommerceSubmission submission) async {
app/lib/pages/admin/admin_moderation_page.dart:  Future<void> _reject(CommerceSubmission submission) async {
app/lib/pages/map_admin_editor_page.dart:class MapAdminEditorPage extends StatelessWidget {
app/lib/pages/map_admin_editor_page.dart:  const MapAdminEditorPage({super.key});
app/lib/services/commerce/commerce_service.dart:class CommerceService {
app/lib/services/commerce/commerce_service.dart:  static final CommerceService instance = CommerceService._internal();
app/lib/services/commerce/commerce_service.dart:  CommerceService._internal();
app/lib/services/commerce/commerce_service.dart:    final submission = CommerceSubmission.fromFirestore(doc);
app/lib/services/commerce/commerce_service.dart:  Stream<List<CommerceSubmission>> watchMySubmissions({
app/lib/services/commerce/commerce_service.dart:          .map((doc) => CommerceSubmission.fromFirestore(doc))
app/lib/services/commerce/commerce_service.dart:  Stream<List<CommerceSubmission>> watchPendingSubmissions({
app/lib/services/commerce/commerce_service.dart:          .map((doc) => CommerceSubmission.fromFirestore(doc))
app/lib/services/commerce/commerce_service.dart:      final callable = _functions.httpsCallable('approveCommerceSubmission');
app/lib/services/commerce/commerce_service.dart:      final callable = _functions.httpsCallable('rejectCommerceSubmission');
app/lib/services/commerce/commerce_service.dart:  Future<CommerceSubmission?> getSubmission(String submissionId) async {
app/lib/services/commerce/commerce_service.dart:    return CommerceSubmission.fromFirestore(doc);
app/lib/services/commerce/commerce_service.dart:  Stream<CommerceSubmission?> watchSubmission(String submissionId) {
app/lib/services/commerce/commerce_service.dart:      return CommerceSubmission.fromFirestore(doc);
app/lib/services/commerce/commerce_service.dart:  Future<bool> canSubmitCommerce() async {
app/lib/pages/group/admin_group_dashboard_page.dart:// Dashboard Administrateur Groupe
app/lib/pages/group/admin_group_dashboard_page.dart:class AdminGroupDashboardPage extends StatefulWidget {
app/lib/pages/group/admin_group_dashboard_page.dart:  const AdminGroupDashboardPage({super.key});
app/lib/pages/group/admin_group_dashboard_page.dart:  State<AdminGroupDashboardPage> createState() => _AdminGroupDashboardPageState();
app/lib/pages/group/admin_group_dashboard_page.dart:class _AdminGroupDashboardPageState extends State<AdminGroupDashboardPage> {
app/lib/pages/group/admin_group_dashboard_page.dart:  GroupAdmin? _admin;
app/lib/pages/group/admin_group_dashboard_page.dart:        title: const Text('Dashboard Admin Groupe'),
app/lib/commerce_module_single_file.dart:    final repo = CommerceRepository();
app/lib/commerce_module_single_file.dart:class CommerceRepository {
app/lib/commerce_module_single_file.dart:  CommerceRepository({FirebaseFirestore? db}) : _db = db ?? FirebaseFirestore.instance;
app/lib/commerce_module_single_file.dart:  final CommerceRepository commerceRepo;
app/lib/commerce_module_single_file.dart:    CommerceRepository? commerceRepo,
app/lib/commerce_module_single_file.dart:  })  : commerceRepo = commerceRepo ?? CommerceRepository(),
app/lib/commerce_module_single_file.dart:                        final status = CommerceRepository._computeStockStatus(stockQty, alertQty);
app/lib/INTEGRATION_EXAMPLES.dart:/// Voir la documentation Commerce pour les patterns d'int√©gration actuels.
app/lib/pages/account_admin_page.dart:class AccountAndAdminPage extends StatefulWidget {
app/lib/pages/account_admin_page.dart:  const AccountAndAdminPage({super.key});
app/lib/pages/account_admin_page.dart:  State<AccountAndAdminPage> createState() => _AccountAndAdminPageState();
app/lib/pages/account_admin_page.dart:class _AccountAndAdminPageState extends State<AccountAndAdminPage> {
app/lib/pages/account_admin_page.dart:        final showSuperAdminCommerce = isSuperAdmin || isStephane;
app/lib/pages/account_admin_page.dart:                          title: "Dashboard Administrateur",
app/lib/pages/account_admin_page.dart:                                builder: (_) => const AdminMainDashboard(),
app/lib/pages/account_admin_page.dart:                        if (showSuperAdminCommerce) ...[
app/lib/pages/account_admin_page.dart:                          const _SectionTitle('Commerce (SuperAdmin)'),
app/lib/pages/account_admin_page.dart:                          _SuperAdminCommerceSection(
app/lib/pages/account_admin_page.dart:class _SuperAdminCommerceSection extends StatelessWidget {
app/lib/pages/account_admin_page.dart:  const _SuperAdminCommerceSection({required this.shopId, required this.email});
app/lib/pages/account_admin_page.dart:            _CommerceQuickLinks(shopId: shopId),
app/lib/pages/account_admin_page.dart:            _CommercePathsCard(shopId: shopId),
app/lib/pages/account_admin_page.dart:                      _CommerceProductTile(data: doc.data()),
app/lib/pages/account_admin_page.dart:class _CommerceQuickLinks extends StatelessWidget {
app/lib/pages/account_admin_page.dart:  const _CommerceQuickLinks({required this.shopId});
app/lib/pages/account_admin_page.dart:        _CommerceLinkChip(
app/lib/pages/account_admin_page.dart:        _CommerceLinkChip(
app/lib/pages/account_admin_page.dart:                builder: (_) => AdminStockPage(shopId: shopId),
app/lib/pages/account_admin_page.dart:        _CommerceLinkChip(
app/lib/pages/account_admin_page.dart:                builder: (_) => const CommerceAnalyticsPage(),
app/lib/pages/account_admin_page.dart:        _CommerceLinkChip(
app/lib/pages/account_admin_page.dart:                builder: (_) => const AdminProductCategoriesPage(),
app/lib/pages/account_admin_page.dart:class _CommercePathsCard extends StatelessWidget {
app/lib/pages/account_admin_page.dart:  const _CommercePathsCard({required this.shopId});
app/lib/pages/account_admin_page.dart:            _CommercePathRow(
app/lib/pages/account_admin_page.dart:          _CommercePathRow(
app/lib/pages/account_admin_page.dart:class _CommercePathRow extends StatelessWidget {
app/lib/pages/account_admin_page.dart:  const _CommercePathRow({required this.label, required this.onCopy});
app/lib/pages/account_admin_page.dart:class _CommerceLinkChip extends StatelessWidget {
app/lib/pages/account_admin_page.dart:  const _CommerceLinkChip({
app/lib/pages/account_admin_page.dart:class _CommerceProductTile extends StatelessWidget {
app/lib/pages/account_admin_page.dart:  const _CommerceProductTile({required this.data});
app/lib/pages/admin_dashboard_page_REMOVED.dart:// Cette page a √©t√© obsol√®te et consolid√©e dans AdminMainDashboard
app/lib/pages/business_signup_page.dart:    'Commerce',
app/lib/pages/account_page.dart:  bool _canSubmitCommerce = false;
app/lib/pages/account_page.dart:    _checkCommercePermissions();
app/lib/pages/account_page.dart:  Future<void> _checkCommercePermissions() async {
app/lib/pages/account_page.dart:      final canSubmit = await CommerceService.instance.canSubmitCommerce();
app/lib/pages/account_page.dart:        _canSubmitCommerce = canSubmit;
app/lib/pages/account_page.dart:            // Section Commerce pour utilisateurs autoris√©s
app/lib/pages/account_page.dart:            if (_canSubmitCommerce)
app/lib/pages/account_page.dart:                  child: CommerceSectionCard(),
app/lib/pages/account_page.dart:                              builder: (context) => const AccountAndAdminPage(),
app/lib/pages/group_profile_page.dart:      length: 5, // Ajout onglet Commerce
app/lib/pages/group_profile_page.dart:                    Tab(text: 'Commerce'),
app/lib/pages/group_profile_page.dart:                    _CommerceTab(groupId: widget.groupId),
app/lib/pages/group_profile_page.dart:// Onglet Commerce pour g√©rer les articles du shop
app/lib/pages/group_profile_page.dart:class _CommerceTab extends StatelessWidget {
app/lib/pages/group_profile_page.dart:  const _CommerceTab({required this.groupId});
app/lib/pages/admin_dashboard_page.dart:class AdminDashboardPage extends StatelessWidget {
app/lib/pages/admin_dashboard_page.dart:  const AdminDashboardPage({super.key});
app/lib/pages/commerce/create_media_page.dart:  final _service = CommerceService.instance;
app/lib/pages/commerce/create_media_page.dart:  CommerceSubmission? _existing;
app/lib/pages/commerce/create_product_page.dart:  final _service = CommerceService.instance;
app/lib/pages/commerce/create_product_page.dart:  CommerceSubmission? _existing;
app/lib/pages/commerce/my_submissions_page.dart:  final _service = CommerceService.instance;
app/lib/pages/commerce/my_submissions_page.dart:    return StreamBuilder<List<CommerceSubmission>>(
app/lib/pages/commerce/my_submissions_page.dart:  void _edit(CommerceSubmission submission) {
app/lib/pages/commerce/my_submissions_page.dart:  Future<void> _delete(CommerceSubmission submission) async {
app/lib/pages/commerce/my_submissions_page.dart:  Future<void> _resubmit(CommerceSubmission submission) async {
app/lib/widgets/commerce/moderation_tile.dart:  final CommerceSubmission submission;
app/lib/widgets/commerce/commerce_section_card.dart:/// Carte Commerce pour int√©gration dans les profils
app/lib/widgets/commerce/commerce_section_card.dart:class CommerceSectionCard extends StatelessWidget {
app/lib/widgets/commerce/commerce_section_card.dart:  const CommerceSectionCard({super.key});
app/lib/widgets/commerce/commerce_section_card.dart:                const Text('Commerce', style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold)),

### 4.3 Drawer / Burger / Menu boutique

app/lib/l10n/app_localizations_fr.dart:  String get menu => 'Menu';
app/lib/l10n/app_localizations_en.dart:  String get menu => 'Menu';
app/lib/l10n/app_localizations.dart:  /// **'Menu'**
app/lib/l10n/app_en.arb:  "menu": "Menu",
app/lib/l10n/app_fr.arb:  "menu": "Menu",
app/lib/pages/storex_shop_page.dart:      drawer: _StorexDrawer(shopId: shopId, groupId: groupId),
app/lib/pages/storex_shop_page.dart:            onPressed: () => Scaffold.of(ctx).openDrawer(),
app/lib/pages/storex_shop_page.dart:class _StorexDrawer extends StatelessWidget {
app/lib/pages/storex_shop_page.dart:  const _StorexDrawer({required this.shopId, required this.groupId});
app/lib/pages/storex_shop_page.dart:    return Drawer(
app/lib/pages/storex_shop_page.dart:      drawer: _StorexDrawer(shopId: shopId, groupId: groupId),
app/lib/pages/storex_shop_page.dart:            onPressed: () => Scaffold.of(ctx).openDrawer(),
app/lib/pages/home_map_page_3d.dart:// Menu vertical: modes/actions (filtrage POIs)
app/lib/pages/home_map_page_3d.dart:  bool _showActionsMenu = false;
app/lib/pages/home_map_page_3d.dart:  void _toggleActionsMenu() {
app/lib/pages/home_map_page_3d.dart:    if (_showActionsMenu) {
app/lib/pages/home_map_page_3d.dart:        if (mounted && _showActionsMenu) {
app/lib/pages/home_map_page_3d.dart:          setState(() => _showActionsMenu = false);
app/lib/pages/home_map_page_3d.dart:    setState(() => _showActionsMenu = true);
app/lib/pages/home_map_page_3d.dart:      if (mounted && _showActionsMenu) {
app/lib/pages/home_map_page_3d.dart:          if (mounted && _showActionsMenu) {
app/lib/pages/home_map_page_3d.dart:            setState(() => _showActionsMenu = false);
app/lib/pages/home_map_page_3d.dart:            if (_showActionsMenu)
app/lib/pages/home_map_page_3d.dart:                        setState(() => _showActionsMenu = false);
app/lib/pages/home_map_page_3d.dart:                        _toggleActionsMenu();
app/lib/pages/superadmin_articles_page.dart:                      onTap: () => _showArticleMenu(article),
app/lib/pages/superadmin_articles_page.dart:  void _showArticleMenu(SuperadminArticle article) {
app/lib/pages/home_map_page_web.dart:  bool _showActionsMenu = false;
app/lib/pages/home_map_page_web.dart:  void _toggleActionsMenu() {
app/lib/pages/home_map_page_web.dart:    if (_showActionsMenu) {
app/lib/pages/home_map_page_web.dart:        if (mounted && _showActionsMenu) {
app/lib/pages/home_map_page_web.dart:          setState(() => _showActionsMenu = false);
app/lib/pages/home_map_page_web.dart:    setState(() => _showActionsMenu = true);
app/lib/pages/home_map_page_web.dart:      if (mounted && _showActionsMenu) {
app/lib/pages/home_map_page_web.dart:          if (mounted && _showActionsMenu) {
app/lib/pages/home_map_page_web.dart:            setState(() => _showActionsMenu = false);
app/lib/pages/home_map_page_web.dart:  Future<void> _openMapQuickMenu() async {
app/lib/pages/home_map_page_web.dart:                visible: _showActionsMenu,
app/lib/pages/home_map_page_web.dart:                        setState(() => _showActionsMenu = false);
app/lib/pages/home_map_page_web.dart:                          setState(() => _showActionsMenu = false);
app/lib/pages/home_map_page_web.dart:                                  onTap: _openMapQuickMenu,
app/lib/pages/home_map_page_web.dart:                        _toggleActionsMenu();
app/lib/pages/default_map_page.dart:// Menu vertical: modes/actions (pour refl√©ter la s√©lection UI)
app/lib/pages/default_map_page.dart:  bool _showActionsMenu = false;
app/lib/pages/default_map_page.dart:      if (mounted && _showActionsMenu) {
app/lib/pages/default_map_page.dart:          if (mounted && _showActionsMenu) {
app/lib/pages/default_map_page.dart:            setState(() => _showActionsMenu = false);
app/lib/pages/default_map_page.dart:                if (_showActionsMenu)
app/lib/pages/default_map_page.dart:                            setState(() => _showActionsMenu = false);
app/lib/pages/default_map_page.dart:                              () => _showActionsMenu = !_showActionsMenu,
app/lib/pages/default_map_page.dart:                            if (_showActionsMenu) {
app/lib/commerce_module_single_file.dart:                      final selected = await _pickFromMenu<String?>(
app/lib/commerce_module_single_file.dart:                      final selected = await _pickFromMenu<bool?>(
app/lib/commerce_module_single_file.dart:                      final selected = await _pickFromMenu<String?>(
app/lib/commerce_module_single_file.dart:Future<T?> _pickFromMenu<T>(

### 4.4 Routing (GoRouter / Navigator / routes)

app/lib/admin/create_circuit_assistant_page.dart:        MaterialPageRoute(
app/lib/admin/create_circuit_assistant_page.dart:                      MaterialPageRoute(
app/lib/admin/create_circuit_assistant_page.dart:                      MaterialPageRoute(
app/lib/admin/create_circuit_assistant_page.dart:                      MaterialPageRoute(
app/lib/admin/mapmarket_projects_page.dart:                          Navigator.pushNamed(
app/lib/admin/mapmarket_projects_page.dart:    Navigator.pushNamed(
app/lib/admin/admin_pois_simple_page.dart:              MaterialPageRoute(builder: (_) => const POIMarketMapWizardPage()),
app/lib/admin/map_project_wizard_entry_page.dart:    final args = ModalRoute.of(context)?.settings.arguments as Map<String, dynamic>?;
app/lib/admin/admin_circuits_page.dart:              MaterialPageRoute(builder: (_) => const CreateCircuitAssistantPage()),
app/lib/admin/map_project_wizard_page.dart:  bool _isEditingRoute = false;
app/lib/admin/map_project_wizard_page.dart:  Future<void> _saveRoute() async {
app/lib/admin/map_project_wizard_page.dart:      _isEditingRoute = !_isEditingRoute;
app/lib/admin/map_project_wizard_page.dart:      _mapController.setEditingEnabled(enabled: _isEditingRoute);
app/lib/admin/map_project_wizard_page.dart:  void _clearRoute() {
app/lib/admin/map_project_wizard_page.dart:      title: const Text('Circuit / Route (Polyline)'),
app/lib/admin/map_project_wizard_page.dart:                    if (_isEditingRoute) {
app/lib/admin/map_project_wizard_page.dart:                        backgroundColor: _isEditingRoute
app/lib/admin/map_project_wizard_page.dart:                        child: Icon(_isEditingRoute ? Icons.close : Icons.edit),
app/lib/admin/map_project_wizard_page.dart:                        onPressed: _clearRoute,
app/lib/admin/map_project_wizard_page.dart:            onPressed: _saveRoute,
app/lib/admin/admin_main_dashboard.dart:              onTap: () => Navigator.pushNamed(context, '/admin/mapmarket'),
app/lib/admin/admin_main_dashboard.dart:                    onTap: () => Navigator.pushNamed(context, '/mapbox-web'),
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:              onTap: () => Navigator.pushNamed(
app/lib/admin/admin_main_dashboard.dart:                MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                          MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                          MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                MaterialPageRoute(builder: (_) => const UserManagementPage()),
app/lib/admin/admin_main_dashboard.dart:                MaterialPageRoute(builder: (_) => UserProfilePreviewPage()),
app/lib/admin/admin_main_dashboard.dart:                MaterialPageRoute(builder: (_) => const BusinessRequestsPage()),
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                      MaterialPageRoute(builder: (_) => const AdminLogsPage()),
app/lib/admin/admin_main_dashboard.dart:                  MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:      MaterialPageRoute(builder: (_) => const AdminStockPage(shopId: 'global')),
app/lib/admin/admin_main_dashboard.dart:      MaterialPageRoute(builder: (_) => const AdminProductCategoriesPage()),
app/lib/admin/admin_main_dashboard.dart:                MaterialPageRoute(
app/lib/admin/admin_main_dashboard.dart:                MaterialPageRoute(builder: (_) => const POIMarketMapWizardPage()),
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:  static const _srcRoute = "maslive_route";
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:  static const _layerRoute = "maslive_route_line";
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:    await _tryAddSource(_srcRoute, _emptyFeatureCollection());
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:    // 4) Route (ligne principale)
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:        id: _layerRoute,
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:        sourceId: _srcRoute,
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:        sourceId: _srcRoute,
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:    // C) Route
app/lib/admin/assistant_step_by_step/mapbox_native_circuit_map.dart:    await _updateGeoJson(_srcRoute, routeFc);
app/lib/admin/create_circuit_assistant_page_backup.dart:      'description': 'Style standard avec routes et labels',
app/lib/admin/create_circuit_assistant_page_backup.dart:      'description': 'Satellite avec routes et labels',
app/lib/admin/create_circuit_assistant_page_backup.dart:                  label: Text('Suivre routes'),
app/lib/admin/create_circuit_assistant_page_backup.dart:            title: const Text('Aimanter aux routes'),
app/lib/admin/create_circuit_assistant_page_backup.dart:              'Les points s\'alignent automatiquement sur les routes',
app/lib/admin/create_circuit_assistant_page_backup.dart:              title: 'Suivre routes',
app/lib/admin/create_circuit_assistant_page_backup.dart:              description: 'Les points sont automatiquement align√©s sur les routes existantes.',
app/lib/admin/create_circuit_assistant_page_backup.dart:              description: 'Les points sont reli√©s par des lignes droites, ignorant les routes.',
app/lib/admin/create_circuit_assistant_page_backup.dart:        return 'Le trac√© suit automatiquement les routes entre les points';
app/lib/admin/create_circuit_assistant_page_backup.dart:            // Route visualization
app/lib/admin/admin_dashboard_page.dart:                  Navigator.pushNamed(context, '/admin/users');
app/lib/admin/admin_dashboard_page.dart:                  Navigator.pushNamed(context, '/admin/roles');
app/lib/admin/admin_dashboard_page.dart:                    MaterialPageRoute(
app/lib/admin/admin_dashboard_page.dart:                    MaterialPageRoute(
app/lib/admin/admin_dashboard_page.dart:                      MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:            onPressed: () => Navigator.of(context).push(MaterialPageRoute(builder: (_) => _SearchPage(shopId: shopId, groupId: groupId))),
app/lib/pages/storex_shop_page.dart:                      MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                            MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                onTap: () => Navigator.of(context).push(MaterialPageRoute(builder: (_) => _ListPage(shopId: shopId, groupId: groupId, categoryId: catA, title: catA))),
app/lib/pages/storex_shop_page.dart:                onTap: () => Navigator.of(context).push(MaterialPageRoute(builder: (_) => _ListPage(shopId: shopId, groupId: groupId, categoryId: catB, title: catB))),
app/lib/pages/storex_shop_page.dart:                  Navigator.of(context).push(MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                  Navigator.of(context).push(MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                  Navigator.of(context).push(MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                              MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                          MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:            onPressed: () => Navigator.of(context).push(MaterialPageRoute(builder: (_) => _SearchPage(shopId: shopId, groupId: groupId))),
app/lib/pages/storex_shop_page.dart:                onTap: () => Navigator.of(context).push(MaterialPageRoute(builder: (_) => _ListPage(shopId: shopId, groupId: groupId, categoryId: c, title: c))),
app/lib/pages/storex_shop_page.dart:              MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                         MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:                        MaterialPageRoute(
app/lib/pages/storex_shop_page.dart:            onTap: () => Navigator.of(context).push(MaterialPageRoute(builder: (_) => _OrdersPage(repo: repo))),
app/lib/pages/storex_shop_page.dart:            onTap: () => Navigator.of(context).push(MaterialPageRoute(builder: (_) => _WishlistPage(repo: repo))),
app/lib/pages/storex_shop_page.dart:              onTap: () => Navigator.pushNamed(context, '/login'),
app/lib/pages/storex_shop_page.dart:                  onPressed: () => Navigator.pushNamed(context, '/login'),
app/lib/pages/storex_shop_page.dart:                  onPressed: () => Navigator.pushNamed(context, '/login'),
app/lib/pages/login_page.dart:        MaterialPageRoute(builder: (_) => AuthActionRunner(action: action)),
app/lib/pages/login_page.dart:                                  MaterialPageRoute(
app/lib/admin/circuit_wizard_entry_page.dart:        MaterialPageRoute(
app/lib/admin/circuit_wizard_entry_page.dart:      MaterialPageRoute(
app/lib/admin/circuit_wizard_pro_page.dart:          label: 'Trac√© Route',
app/lib/admin/circuit_wizard_pro_page.dart:                _buildStep3Route(),
app/lib/admin/circuit_wizard_pro_page.dart:  Widget _buildStep3Route() {
app/lib/admin/admin_products_page.dart:              MaterialPageRoute(
app/lib/admin/super_admin_space.dart:              () => Navigator.pushNamed(context, '/admin/users'),
app/lib/admin/super_admin_space.dart:              () => Navigator.pushNamed(context, '/admin/roles'),
app/lib/admin/super_admin_space.dart:              () => Navigator.pushNamed(context, '/admin/categories'),
app/lib/admin/super_admin_space.dart:              () => Navigator.pushNamed(context, '/admin/analytics'),
app/lib/admin/super_admin_space.dart:          () => Navigator.pushNamed(context, '/admin/logs'),
app/lib/admin/super_admin_space.dart:          () => Navigator.pushNamed(context, '/admin/settings'),
app/lib/admin/super_admin_space.dart:              onPressed: () => Navigator.pushNamed(context, '/admin/categories'),
app/lib/admin/map_projects_library_page.dart:              MaterialPageRoute(
app/lib/admin/poi_marketmap_wizard_page.dart:                          MaterialPageRoute(
app/lib/admin/user_management_page.dart:      MaterialPageRoute(
app/lib/admin/commerce_analytics_page.dart:                    onTap: () => Navigator.pushNamed(context, '/admin/moderation'),
app/lib/pages/shop/storex_reviews_and_success_pages.dart:/// ROUTES (a enregistrer dans MaterialApp.routes)
app/lib/pages/shop/storex_reviews_and_success_pages.dart:  final String? continueToRoute; // ex: '/shop'
app/lib/pages/shop/storex_reviews_and_success_pages.dart:  const PaymentCompleteArgs({required this.orderCode, this.continueToRoute});
app/lib/pages/shop/storex_reviews_and_success_pages.dart:    this.continueToRoute,
app/lib/pages/shop/storex_reviews_and_success_pages.dart:  final String? continueToRoute;
app/lib/pages/shop/storex_reviews_and_success_pages.dart:  static Route routeFromArgs(Object? args) {
app/lib/pages/shop/storex_reviews_and_success_pages.dart:    return MaterialPageRoute(
app/lib/pages/shop/storex_reviews_and_success_pages.dart:        continueToRoute: a.continueToRoute,
app/lib/pages/shop/storex_reviews_and_success_pages.dart:                    if (continueToRoute != null) {
app/lib/pages/shop/storex_reviews_and_success_pages.dart:                        continueToRoute!,
app/lib/pages/shop/storex_reviews_and_success_pages.dart:  static Route routeFromArgs(Object? args) {
app/lib/pages/shop/storex_reviews_and_success_pages.dart:    return MaterialPageRoute(
app/lib/pages/shop/storex_reviews_and_success_pages.dart:  static Route routeFromArgs(Object? args) {
app/lib/pages/shop/storex_reviews_and_success_pages.dart:    return MaterialPageRoute(
app/lib/pages/shop/storex_reviews_and_success_pages.dart:  static Route routeFromArgs(Object? args) {
app/lib/pages/shop/storex_reviews_and_success_pages.dart:    return MaterialPageRoute(
app/lib/pages/account_page.dart:      Navigator.pushNamed(context, t.route!);
app/lib/pages/account_page.dart:                            MaterialPageRoute(
app/lib/pages/group_profile_page.dart:                              MaterialPageRoute(
app/lib/pages/group_profile_page.dart:              MaterialPageRoute(
app/lib/pages/business_request_page.dart:                onPressed: () => Navigator.pushNamed(context, '/login'),
app/lib/pages/route_display_mapbox_page.dart:      _loadRoute();
app/lib/pages/route_display_mapbox_page.dart:  Future<void> _loadRoute() async {
app/lib/pages/route_display_mapbox_page.dart:      final doc = await _firestore.collection('routes').doc(widget.routeId).get();
app/lib/pages/route_display_mapbox_page.dart:        title: Text(_routeData?['name'] ?? 'Route'),
app/lib/pages/route_display_mapbox_page.dart:                MaterialPageRoute(
app/lib/pages/route_display_mapbox_page.dart:              ? const Center(child: Text('Route introuvable'))
app/lib/pages/role_router_page.dart:/// Route d'aiguillage selon le r√¥le Firestore.
app/lib/pages/product_detail_page.dart:                              MaterialPageRoute(
app/lib/pages/admin_dashboard_page.dart:              MaterialPageRoute(builder: (_) => const RouteDrawingPageLegacy()),
app/lib/pages/admin_dashboard_page.dart:              MaterialPageRoute(builder: (_) => const AddPlacePage()),
app/lib/pages/admin_dashboard_page.dart:            onTap: () => Navigator.pushNamed(context, '/tracking'),
app/lib/pages/admin_dashboard_page.dart:            onTap: () => Navigator.pushNamed(context, '/admin/track-editor'),
app/lib/pages/admin_dashboard_page.dart:            onTap: () => Navigator.pushNamed(context, '/admin/map-library'),
app/lib/pages/admin_dashboard_page.dart:            onTap: () => Navigator.pushNamed(context, '/'),
app/lib/pages/admin_dashboard_page.dart:            onTap: () => Navigator.pushNamed(context, '/map-admin'),
app/lib/pages/admin_dashboard_page.dart:            onTap: () => Navigator.pushNamed(context, '/mapbox-google-light'),
app/lib/pages/admin_dashboard_page.dart:              Navigator.pushNamed(context, isSignedIn ? '/account' : '/login');
app/lib/pages/commerce/my_submissions_page.dart:        MaterialPageRoute(builder: (_) => CreateProductPage(submissionId: submission.id)),
app/lib/pages/commerce/my_submissions_page.dart:        MaterialPageRoute(builder: (_) => CreateMediaPage(submissionId: submission.id)),
app/lib/pages/media_gallery_maslive_instagram_page.dart:      MaterialPageRoute(
app/lib/services/routing_service.dart:  Future<RouteStep?> getRoute(LatLng start, LatLng end) async {
app/lib/services/routing_service.dart:      if (data['routes'] == null || (data['routes'] as List).isEmpty) {
app/lib/services/routing_service.dart:      final route = data['routes'][0] as Map<String, dynamic>;
app/lib/services/routing_service.dart:      String instruction = 'Route';
app/lib/services/routing_service.dart:      // print('Erreur getRoute: $e');
app/lib/services/routing_service.dart:  Future<RouteStep?> getMultiRoute(List<LatLng> waypoints) async {
app/lib/services/routing_service.dart:      if (data['routes'] == null || (data['routes'] as List).isEmpty) {
app/lib/services/routing_service.dart:      final route = data['routes'][0] as Map<String, dynamic>;
app/lib/services/routing_service.dart:      // print('Erreur getMultiRoute: $e');
app/lib/services/routing_service.dart:  String formatRoute(RouteStep route) {
app/lib/pages/home_map_page_3d.dart:                                Navigator.pushNamed(context, '/account-ui');
app/lib/pages/home_map_page_3d.dart:                                Navigator.pushNamed(context, '/login');
app/lib/pages/home_map_page_3d.dart:                          MaterialPageRoute(
app/lib/services/draft_manager.dart:/// Local draft cache pour brouillons de circuits/routes
app/lib/services/draft_manager.dart:  /// Idem pour routes
app/lib/pages/shop_body.dart:            MaterialPageRoute(builder: (_) => const CartPage()),
app/lib/pages/shop_body.dart:                                MaterialPageRoute(
app/lib/pages/shop_body.dart:                              MaterialPageRoute(
app/lib/pages/shop_body.dart:                        MaterialPageRoute(
app/lib/pages/business_account_page.dart:                onPressed: () => Navigator.pushNamed(context, '/login'),
app/lib/pages/business_account_page.dart:                        Navigator.pushNamed(context, '/business-request'),
app/lib/pages/business_account_page.dart:                              Navigator.pushNamed(context, '/business-request'),
app/lib/pages/business_account_page.dart:                              Navigator.pushNamed(context, '/business-request'),
app/lib/pages/professional_articles_page.dart:                              MaterialPageRoute(
app/lib/pages/professional_articles_page.dart:                    MaterialPageRoute(
app/lib/pages/circuit_save_page.dart:                  MaterialPageRoute(builder: (_) => const CreateCircuitAssistantPage()),
app/lib/pages/group/admin_group_dashboard_page.dart:            MaterialPageRoute(
app/lib/pages/group/admin_group_dashboard_page.dart:            MaterialPageRoute(
app/lib/pages/group/admin_group_dashboard_page.dart:            MaterialPageRoute(
app/lib/pages/group/tracker_group_profile_page.dart:            MaterialPageRoute(
app/lib/pages/group/tracker_group_profile_page.dart:            MaterialPageRoute(
app/lib/pages/map_selector_page.dart:      case 'routes':
app/lib/pages/home_map_page_web.dart:      MaterialPageRoute(
app/lib/pages/home_map_page_web.dart:                            MaterialPageRoute(
app/lib/pages/shop_page_new.dart:      MaterialPageRoute(
app/lib/pages/shop_page_new.dart:            MaterialPageRoute(builder: (_) => const CartPage()),
app/lib/pages/shop_page_new.dart:                ).push(MaterialPageRoute(builder: (_) => const CartPage()));
app/lib/pages/shop_page_new.dart:                                MaterialPageRoute(
app/lib/pages/circuit_import_export_page.dart:                  MaterialPageRoute(builder: (_) => const CreateCircuitAssistantPage()),
app/lib/pages/circuit_calculs_validation_page.dart:                  MaterialPageRoute(builder: (_) => const CreateCircuitAssistantPage()),
app/lib/pages/route_display_page.dart:    _loadRoute();
app/lib/pages/route_display_page.dart:  Future<void> _loadRoute() async {
app/lib/pages/route_display_page.dart:        ? await _routingService.getRoute(latlngs[0], latlngs[1])
app/lib/pages/route_display_page.dart:        : await _routingService.getMultiRoute(latlngs);
app/lib/pages/route_display_page.dart:    // Route polyline
app/lib/pages/route_display_page.dart:        title: Text(widget.title ?? "Route"),
app/lib/pages/route_display_page.dart:            onPressed: _loadRoute,
app/lib/pages/route_display_page.dart:                  child: Center(child: Text("Route non trouv√©e")),
app/lib/pages/language_example_page.dart:                  MaterialPageRoute(builder: (_) => LanguageSelectionPage()),
app/lib/pages/default_map_page.dart:                                    Navigator.pushNamed(context, '/account-ui');
app/lib/pages/default_map_page.dart:                                    Navigator.pushNamed(context, '/login');
app/lib/pages/default_map_page.dart:                              MaterialPageRoute(
app/lib/pages/account_admin_page.dart:        ).pushReplacement(MaterialPageRoute(builder: (_) => const LoginPage()));
app/lib/pages/account_admin_page.dart:                            MaterialPageRoute(
app/lib/pages/account_admin_page.dart:                              MaterialPageRoute(
app/lib/pages/account_admin_page.dart:                              MaterialPageRoute(
app/lib/pages/account_admin_page.dart:              MaterialPageRoute(
app/lib/pages/account_admin_page.dart:              MaterialPageRoute(
app/lib/pages/account_admin_page.dart:              MaterialPageRoute(
app/lib/pages/account_admin_page.dart:              MaterialPageRoute(
app/lib/pages/group_member_page.dart:              onPressed: () => Navigator.pushNamed(context, '/'),
app/lib/pages/pending_products_page.dart:                        MaterialPageRoute(
app/lib/commerce_module_single_file.dart:                              MaterialPageRoute(
app/lib/commerce_module_single_file.dart://    Navigator.push(context, MaterialPageRoute(
app/lib/commerce_module_single_file.dart://    Navigator.push(context, MaterialPageRoute(
app/lib/ui/map/maslive_map_controller.dart:  /// - mapbox://styles/mapbox/satellite-streets-v12 (satellite + routes)
app/lib/ui/widgets/smart_image_widgets.dart:      MaterialPageRoute(
app/lib/ui/widgets/smart_image_widgets.dart:              MaterialPageRoute(
app/lib/pages/legacy_stubs/route_drawing_page_legacy_stub.dart:      appBar: AppBar(title: const Text("Route drawing (legacy disabled)")),
app/lib/pages/checkout/storex_checkout_stripe.dart:        .push(MaterialPageRoute(builder: (_) => const StorexDeliveryPage()));
app/lib/pages/checkout/storex_checkout_stripe.dart:                    MaterialPageRoute(
app/lib/pages/checkout/storex_checkout_stripe.dart:          continueToRoute: '/boutique',
app/lib/pages/create_circuit_features_page.dart:          "D√©tection \"Hors-Route\"",
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/circuit-draw');
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/circuit-import-export');
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/circuit-calculs');
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/admin/circuits');
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/search');
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/tracking');
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/favorites');
app/lib/pages/create_circuit_features_page.dart:        Navigator.pushNamed(context, '/map-admin');
app/lib/l10n/app_localizations_fr.dart:  String get routes => 'Routes';
app/lib/l10n/app_localizations_fr.dart:  String get drawRoute => 'Tracer un parcours';
app/lib/l10n/app_localizations_en.dart:  String get routes => 'Routes';
app/lib/l10n/app_localizations_en.dart:  String get routeSaved => 'Route saved';
app/lib/l10n/app_localizations_en.dart:  String get drawRoute => 'Draw a route';
app/lib/l10n/app_localizations.dart:  /// No description provided for @routes.
app/lib/l10n/app_localizations.dart:  String get routes;
app/lib/l10n/app_localizations.dart:  /// No description provided for @drawRoute.
app/lib/l10n/app_localizations.dart:  String get drawRoute;
app/lib/l10n/app_es.arb:  "routes": "Rutas",
app/lib/l10n/app_es.arb:  "drawRoute": "Trazar una ruta",
app/lib/l10n/app_en.arb:  "routes": "Routes",
app/lib/l10n/app_en.arb:  "routeSaved": "Route saved",
app/lib/l10n/app_en.arb:  "drawRoute": "Draw a route",
app/lib/l10n/app_fr.arb:  "routes": "Routes",
app/lib/l10n/app_fr.arb:  "drawRoute": "Tracer un parcours",
app/lib/l10n/app_localizations_es.dart:  String get routes => 'Rutas';
app/lib/l10n/app_localizations_es.dart:  String get drawRoute => 'Trazar una ruta';
app/lib/models/map_preset_model.dart:  final String type; // 'circuits', 'pois', 'routes', 'geofence', etc.
app/lib/session/require_signin.dart:    await Navigator.pushNamed(context, '/login');
app/lib/widgets/premium_gate.dart:              MaterialPageRoute(builder: (_) => const PaywallPage()),
app/lib/examples/image_management_integration_example.dart:                          MaterialPageRoute(
app/lib/main.dart:            initialRoute: '/splash',
app/lib/main.dart:            routes: {
app/lib/main.dart:                final args = ModalRoute.of(ctx)?.settings.arguments as Map?;
app/lib/main.dart:                    ModalRoute.of(ctx)?.settings.arguments as String?;
app/lib/main.dart:                final args = ModalRoute.of(ctx)?.settings.arguments;
app/lib/main.dart:                    continueToRoute: args.continueToRoute,
app/lib/main.dart:                final args = ModalRoute.of(ctx)?.settings.arguments;
app/lib/main.dart:                final args = ModalRoute.of(ctx)?.settings.arguments;
app/lib/main.dart:                final args = ModalRoute.of(ctx)?.settings.arguments;
app/lib/main.dart:                final args = ModalRoute.of(ctx)?.settings.arguments as Map?;

### 4.5 Roles / permissions (groupAdmin)

app/lib/admin/admin_main_dashboard.dart:                _currentUser?.role ?? 'admin',
app/lib/admin/admin_main_dashboard.dart:                        _currentUser?.role ?? 'admin',
app/lib/admin/role_management_page.dart:                stream: _firestore.collection('roles').orderBy('priority').snapshots(),
app/lib/admin/role_management_page.dart:                  var roles = snapshot.data!.docs;
app/lib/admin/role_management_page.dart:                    roles = roles.where((doc) {
app/lib/admin/role_management_page.dart:                    itemCount: roles.length,
app/lib/admin/role_management_page.dart:                      final roleDoc = roles[index];
app/lib/admin/role_management_page.dart:                // Permissions
app/lib/admin/role_management_page.dart:                  'Permissions:',
app/lib/admin/role_management_page.dart:                        _formatPermissionName(perm),
app/lib/admin/role_management_page.dart:  String _formatPermissionName(String permission) {
app/lib/admin/role_management_page.dart:          .where('role', isEqualTo: roleId)
app/lib/admin/business_requests_page.dart:  bool _isAdmin = false;
app/lib/admin/business_requests_page.dart:        _isAdmin = appUser?.isAdmin == true;
app/lib/admin/business_requests_page.dart:        _isAdmin = false;
app/lib/admin/business_requests_page.dart:    if (!_isAdmin) {
app/lib/admin/admin_gate.dart:            : user.isAdminRole;
app/lib/admin/admin_gate.dart:            : user.isAdminRole;
app/lib/admin/admin_gate.dart:  Future<bool> isAdmin() async {
app/lib/admin/admin_gate.dart:    final hasAccess = await isAdmin();
app/lib/admin/user_profile_preview_page.dart:        // Permissions
app/lib/admin/user_profile_preview_page.dart:        _buildSectionTitle('Permissions'),
app/lib/admin/user_profile_preview_page.dart:        ..._getPermissionsForProfile(profileType).map(
app/lib/admin/user_profile_preview_page.dart:          (permission) => _buildPermissionItem(
app/lib/admin/user_profile_preview_page.dart:  Widget _buildPermissionItem(String label, bool granted) {
app/lib/admin/user_profile_preview_page.dart:  List<Map<String, dynamic>> _getPermissionsForProfile(String profileType) {
app/lib/admin/super_admin_space.dart:        final role = doc.data()['role']?.toString() ?? 'user';
app/lib/admin/super_admin_space.dart:        _usersByRole[role] = (_usersByRole[role] ?? 0) + 1;
app/lib/admin/super_admin_space.dart:              () => Navigator.pushNamed(context, '/admin/roles'),
app/lib/admin/admin_analytics_page.dart:        'role': data['role'],
app/lib/admin/admin_analytics_page.dart:                      backgroundColor: MasLiveTheme.getRoleColor(activity['role']),
app/lib/admin/admin_analytics_page.dart:                        activity['role'],
app/lib/admin/admin_analytics_page.dart:                    backgroundColor: MasLiveTheme.getRoleColor(activity['role']).withValues(alpha: 0.2),
app/lib/admin/user_management_page.dart:  UserRoleType? _filterRole;
app/lib/admin/user_management_page.dart:            ...UserRoleType.values.map((role) => ListTile(
app/lib/admin/user_management_page.dart:                    MasLiveTheme.getRoleIcon(role),
app/lib/admin/user_management_page.dart:                    color: MasLiveTheme.getRoleColor(role),
app/lib/admin/user_management_page.dart:                  title: Text(RoleDefinition.getRoleLabel(role)),
app/lib/admin/user_management_page.dart:                    setState(() => _filterRole = role);
app/lib/admin/user_management_page.dart:          backgroundColor: MasLiveTheme.getRoleColor(user.role),
app/lib/admin/user_management_page.dart:                  MasLiveTheme.getRoleIcon(user.role),
app/lib/admin/user_management_page.dart:                  color: MasLiveTheme.getRoleColor(user.role),
app/lib/admin/user_management_page.dart:                    color: MasLiveTheme.getRoleColor(user.role),
app/lib/admin/user_edit_page.dart:  final _permissionService = PermissionService.instance;
app/lib/admin/user_edit_page.dart:  late UserRoleType _selectedRole;
app/lib/admin/user_edit_page.dart:    _selectedRole = RoleDefinition.roleFromString(widget.user.role);
app/lib/admin/user_edit_page.dart:    final currentRole = RoleDefinition.roleFromString(_currentUser!.role);
app/lib/admin/user_edit_page.dart:    final targetRole = RoleDefinition.roleFromString(widget.user.role);
app/lib/admin/user_edit_page.dart:    if (currentRole == UserRoleType.admin) {
app/lib/admin/user_edit_page.dart:      return targetRole != UserRoleType.superAdmin && 
app/lib/admin/user_edit_page.dart:             targetRole != UserRoleType.admin;
app/lib/admin/user_edit_page.dart:    final currentRole = RoleDefinition.roleFromString(_currentUser!.role);
app/lib/admin/user_edit_page.dart:    final targetRole = RoleDefinition.roleFromString(widget.user.role);
app/lib/admin/user_edit_page.dart:    if (currentRole == UserRoleType.admin) {
app/lib/admin/user_edit_page.dart:      return targetRole != UserRoleType.superAdmin;
app/lib/admin/user_edit_page.dart:      if (selectedRoleKey != widget.user.role && _canEditRole()) {
app/lib/admin/user_edit_page.dart:        updates['role'] = selectedRoleKey;
app/lib/admin/user_edit_page.dart:        if (_selectedRole == UserRoleType.group && newGroupId.isEmpty) {
app/lib/admin/user_edit_page.dart:              DropdownButtonFormField<UserRoleType>(
app/lib/admin/user_edit_page.dart:                items: UserRoleType.values.map((role) {
app/lib/admin/user_edit_page.dart:                    value: role,
app/lib/admin/user_edit_page.dart:                          MasLiveTheme.getRoleIcon(role),
app/lib/admin/user_edit_page.dart:                          color: MasLiveTheme.getRoleColor(role),
app/lib/admin/user_edit_page.dart:                        Text(RoleDefinition.getRoleLabel(role)),
app/lib/admin/admin_dashboard_page.dart:  Map<UserRoleType, int> _roleStats = {};
app/lib/admin/admin_dashboard_page.dart:        _roleStats = results[1] as Map<UserRoleType, int>;
app/lib/admin/admin_dashboard_page.dart:                  ? MasLiveTheme.getRoleColor(_currentUser!.role)
app/lib/admin/admin_dashboard_page.dart:              children: UserRoleType.values.map((role) {
app/lib/admin/admin_dashboard_page.dart:                final count = _roleStats[role] ?? 0;
app/lib/admin/admin_dashboard_page.dart:                        MasLiveTheme.getRoleIcon(role),
app/lib/admin/admin_dashboard_page.dart:                        color: MasLiveTheme.getRoleColor(role),
app/lib/admin/admin_dashboard_page.dart:                              RoleDefinition.getRoleLabel(role),
app/lib/admin/admin_dashboard_page.dart:                                MasLiveTheme.getRoleColor(role),
app/lib/admin/admin_dashboard_page.dart:                  Navigator.pushNamed(context, '/admin/roles');
app/lib/services/localization_service.dart:      'common_save': 'Guardar',
app/lib/services/permission_service.dart:class PermissionService {
app/lib/services/permission_service.dart:  static final PermissionService _instance = PermissionService._internal();
app/lib/services/permission_service.dart:  static PermissionService get instance => _instance;
app/lib/services/permission_service.dart:  PermissionService._internal();
app/lib/services/permission_service.dart:  factory PermissionService() => _instance;
app/lib/services/permission_service.dart:      final snapshot = await _firestore.collection('roles').get();
app/lib/services/permission_service.dart:          .where((role) => role.isActive)
app/lib/services/permission_service.dart:      final doc = await _firestore.collection('roles').doc(roleId).get();
app/lib/services/permission_service.dart:          .firstWhere((r) => r.id == roleId, orElse: () => RoleDefinition.defaultUserRole);
app/lib/services/permission_service.dart:      final roles = await getAllRoles();
app/lib/services/permission_service.dart:      _rolesCache = {for (var role in roles) role.id: role};
app/lib/services/permission_service.dart:  Future<bool> hasPermission(
app/lib/services/permission_service.dart:    Permission permission, {
app/lib/services/permission_service.dart:      final roleString = userData['role'] as String? ?? 'user';
app/lib/services/permission_service.dart:      final isAdmin = userData['isAdmin'] as bool? ?? false;
app/lib/services/permission_service.dart:      if (isAdmin) return true;
app/lib/services/permission_service.dart:        if (_isGroupPermission(permission) && groupId != null) {
app/lib/services/permission_service.dart:  Future<bool> hasAnyPermission(
app/lib/services/permission_service.dart:    List<Permission> permissions, {
app/lib/services/permission_service.dart:      if (await hasPermission(userId, permission, groupId: groupId)) {
app/lib/services/permission_service.dart:  Future<bool> hasAllPermissions(
app/lib/services/permission_service.dart:    List<Permission> permissions, {
app/lib/services/permission_service.dart:      if (!await hasPermission(userId, permission, groupId: groupId)) {
app/lib/services/permission_service.dart:  Future<List<Permission>> getUserPermissions(String userId) async {
app/lib/services/permission_service.dart:      final roleString = userData['role'] as String? ?? 'user';
app/lib/services/permission_service.dart:      final isAdmin = userData['isAdmin'] as bool? ?? false;
app/lib/services/permission_service.dart:      if (isAdmin) return Permission.values;
app/lib/services/permission_service.dart:  bool _isGroupPermission(Permission permission) {
app/lib/services/permission_service.dart:      Permission.manageGroupInfo,
app/lib/services/permission_service.dart:      Permission.manageGroupProducts,
app/lib/services/permission_service.dart:      Permission.viewGroupOrders,
app/lib/services/permission_service.dart:      Permission.viewGroupStats,
app/lib/services/permission_service.dart:      Permission.manageGroupMembers,
app/lib/services/permission_service.dart:  /// Convertir UserRoleType en string
app/lib/services/permission_service.dart:  String _roleTypeToString(UserRoleType type) {
app/lib/services/permission_service.dart:    required UserRoleType roleType,
app/lib/services/permission_service.dart:        'role': _roleTypeToString(roleType),
app/lib/services/permission_service.dart:      if (roleType == UserRoleType.group) {
app/lib/services/permission_service.dart:      // Mettre √† jour isAdmin pour la r√©trocompatibilit√©
app/lib/services/permission_service.dart:      updates['isAdmin'] = roleType == UserRoleType.admin || 
app/lib/services/permission_service.dart:                           roleType == UserRoleType.superAdmin;
app/lib/services/permission_service.dart:  Future<void> saveRoleDefinition(RoleDefinition role) async {
app/lib/services/permission_service.dart:          .collection('roles')
app/lib/services/permission_service.dart:          .doc(role.id)
app/lib/services/permission_service.dart:          .set(role.toFirestore(), SetOptions(merge: true));
app/lib/services/permission_service.dart:      for (final role in RoleDefinition.defaultRoles) {
app/lib/services/permission_service.dart:        final ref = _firestore.collection('roles').doc(role.id);
app/lib/services/permission_service.dart:        batch.set(ref, role.toFirestore(), SetOptions(merge: true));
app/lib/services/permission_service.dart:  Future<Map<String, dynamic>> getUserPermissionsSummary(String userId) async {
app/lib/services/permission_service.dart:          'role': 'none',
app/lib/services/permission_service.dart:      final roleString = userData['role'] as String? ?? 'user';
app/lib/services/permission_service.dart:      final isAdmin = userData['isAdmin'] as bool? ?? false;
app/lib/services/permission_service.dart:      final permissions = await getUserPermissions(userId);
app/lib/services/permission_service.dart:        'role': roleString,
app/lib/services/permission_service.dart:        'isAdmin': isAdmin,
app/lib/services/permission_service.dart:        'permissionsByCategory': _groupPermissionsByCategory(permissions),
app/lib/services/permission_service.dart:  Map<String, List<String>> _groupPermissionsByCategory(List<Permission> permissions) {
app/lib/services/permission_service.dart:      final managerRole = managerData['role'] as String? ?? 'user';
app/lib/services/permission_service.dart:        final targetRole = targetData['role'] as String? ?? 'user';
app/lib/services/permission_service.dart:        final targetRole = targetData['role'] as String? ?? 'user';
app/lib/services/permission_service.dart:      final role = userData['role'] as String? ?? 'user';
app/lib/services/permission_service.dart:      final isAdmin = userData['isAdmin'] as bool? ?? false;
app/lib/services/permission_service.dart:      // Superadmin ou isAdmin + role admin
app/lib/services/permission_service.dart:      return role == 'superAdmin' || role == 'superadmin' || 
app/lib/services/permission_service.dart:             (isAdmin && (role == 'admin' || role == 'Admin'));
app/lib/services/group/group_export_service.dart:        'role': session.role,
app/lib/services/group/group_export_service.dart:    buffer.writeln('sessionId,uid,role,startedAt,endedAt,durationSec,distanceKm,ascentM,descentM,avgSpeedKmh,pointsCount');
app/lib/services/group/group_export_service.dart:      buffer.write(',${session.role}');
app/lib/pages/home_map_page_3d.dart:    _bootstrapLocation(); // Permissions GPS + position initiale
app/lib/pages/home_map_page_3d.dart:    final ok = await _ensureLocationPermission(request: true);
app/lib/pages/home_map_page_3d.dart:  Future<bool> _ensureLocationPermission({required bool request}) async {
app/lib/pages/home_map_page_3d.dart:      var permission = await Geolocator.checkPermission();
app/lib/pages/home_map_page_3d.dart:      if (permission == LocationPermission.denied && request) {
app/lib/pages/home_map_page_3d.dart:        permission = await Geolocator.requestPermission();
app/lib/pages/home_map_page_3d.dart:      if (permission == LocationPermission.denied) {
app/lib/pages/home_map_page_3d.dart:      if (permission == LocationPermission.deniedForever) {
app/lib/pages/home_map_page_3d.dart:        final role = doc.data()?['role'] as String?;
app/lib/pages/home_map_page_3d.dart:        final isAdmin = doc.data()?['isAdmin'] as bool? ?? false;
app/lib/pages/home_map_page_3d.dart:            role == 'superAdmin' ||
app/lib/pages/home_map_page_3d.dart:            role == 'superadmin' ||
app/lib/pages/home_map_page_3d.dart:            (isAdmin && (role == 'admin' || role == 'Admin'));
app/lib/services/group/group_tracking_service.dart:    required String role, // "admin" ou "tracker"
app/lib/services/group/group_tracking_service.dart:    final permission = await Geolocator.checkPermission();
app/lib/services/group/group_tracking_service.dart:    if (permission == LocationPermission.denied || 
app/lib/services/group/group_tracking_service.dart:        permission == LocationPermission.deniedForever) {
app/lib/services/group/group_tracking_service.dart:      final requested = await Geolocator.requestPermission();
app/lib/services/group/group_tracking_service.dart:      if (requested == LocationPermission.denied || 
app/lib/services/group/group_tracking_service.dart:          requested == LocationPermission.deniedForever) {
app/lib/services/group/group_tracking_service.dart:        throw Exception('Permission GPS refus√©e');
app/lib/services/group/group_tracking_service.dart:      role: role,
app/lib/services/group/group_tracking_service.dart:      _handleNewPosition(position, adminGroupId, role);
app/lib/services/group/group_tracking_service.dart:    String role,
app/lib/services/group/group_tracking_service.dart:    if (role == 'admin') {
app/lib/services/group/group_tracking_service.dart:      'role': role,
app/lib/pages/role_management_page.dart:  List<RoleDefinition> _roles = [];
app/lib/pages/role_management_page.dart:      final roles = await PermissionService.instance.getAllRoles();
app/lib/pages/role_management_page.dart:        _roles = roles;
app/lib/pages/role_management_page.dart:      await PermissionService.instance.initializeDefaultRoles();
app/lib/pages/role_management_page.dart:          PermissionGuard(
app/lib/pages/role_management_page.dart:            permission: Permission.manageRoles,
app/lib/pages/role_management_page.dart:      floatingActionButton: PermissionGuard(
app/lib/pages/role_management_page.dart:        permission: Permission.manageRoles,
app/lib/pages/role_management_page.dart:    if (_roles.isEmpty) {
app/lib/pages/role_management_page.dart:      itemCount: _roles.length,
app/lib/pages/role_management_page.dart:        final role = _roles[index];
app/lib/pages/role_management_page.dart:        return _RoleCard(role: role);
app/lib/pages/role_management_page.dart:  final RoleDefinition role;
app/lib/pages/role_management_page.dart:  const _RoleCard({required this.role});
app/lib/pages/role_management_page.dart:    if (role.priority >= 90) return Colors.red;
app/lib/pages/role_management_page.dart:    if (role.priority >= 50) return Colors.orange;
app/lib/pages/role_management_page.dart:    if (role.priority >= 20) return Colors.blue;
app/lib/pages/role_management_page.dart:    switch (role.roleType) {
app/lib/pages/role_management_page.dart:      case UserRoleType.superAdmin:
app/lib/pages/role_management_page.dart:      case UserRoleType.admin:
app/lib/pages/role_management_page.dart:      case UserRoleType.group:
app/lib/pages/role_management_page.dart:      case UserRoleType.tracker:
app/lib/pages/role_management_page.dart:      case UserRoleType.user:
app/lib/pages/role_management_page.dart:          role.name,
app/lib/pages/role_management_page.dart:            Text(role.description),
app/lib/pages/role_management_page.dart:                  label: Text('Priorit√© ${role.priority}'),
app/lib/pages/role_management_page.dart:                  label: Text('${role.permissions.length} permissions'),
app/lib/pages/role_management_page.dart:                  'Permissions:',
app/lib/pages/role_management_page.dart:                ..._buildPermissionsByCategory(),
app/lib/pages/role_management_page.dart:  List<Widget> _buildPermissionsByCategory() {
app/lib/pages/role_management_page.dart:    final Map<String, List<Permission>> grouped = {};
app/lib/pages/role_management_page.dart:    for (final permission in role.permissions) {
app/lib/pages/role_management_page.dart:class UserRolesManagementPage extends StatefulWidget {
app/lib/pages/role_management_page.dart:  const UserRolesManagementPage({super.key});
app/lib/pages/role_management_page.dart:  State<UserRolesManagementPage> createState() =>
app/lib/pages/role_management_page.dart:      _UserRolesManagementPageState();
app/lib/pages/role_management_page.dart:class _UserRolesManagementPageState extends State<UserRolesManagementPage> {
app/lib/pages/role_management_page.dart:    final canManage = await PermissionService.instance.canManageUser(
app/lib/pages/role_management_page.dart:    final selectedRole = await showDialog<UserRoleType>(
app/lib/pages/role_management_page.dart:        currentRole: UserProfile.parseRole(userData['role'] as String?),
app/lib/pages/role_management_page.dart:        if (selectedRole == UserRoleType.group) {
app/lib/pages/role_management_page.dart:        await PermissionService.instance.assignRole(
app/lib/pages/role_management_page.dart:    final role = userData['role'] as String? ?? 'user';
app/lib/pages/role_management_page.dart:        subtitle: Text('$email\nR√¥le: $role'),
app/lib/pages/role_management_page.dart:        trailing: PermissionGuard(
app/lib/pages/role_management_page.dart:          permission: Permission.manageAllUsers,
app/lib/pages/role_management_page.dart:  final UserRole currentRole;
app/lib/pages/role_management_page.dart:          children: UserRoleType.values.map((roleType) {
app/lib/pages/role_management_page.dart:            return RadioListTile<UserRoleType>(
app/lib/pages/role_management_page.dart:  UserRoleType _getCurrentRoleType() {
app/lib/pages/role_management_page.dart:      case UserRole.user:
app/lib/pages/role_management_page.dart:        return UserRoleType.user;
app/lib/pages/role_management_page.dart:      case UserRole.group:
app/lib/pages/role_management_page.dart:        return UserRoleType.group;
app/lib/pages/role_management_page.dart:      case UserRole.admin:
app/lib/pages/role_management_page.dart:        return UserRoleType.admin;
app/lib/pages/superadmin_articles_page.dart:  Future<bool> _checkGalleryPermission() async {
app/lib/pages/superadmin_articles_page.dart:      final status = await Permission.photos.status;
app/lib/pages/superadmin_articles_page.dart:      final result = await Permission.photos.request();
app/lib/pages/superadmin_articles_page.dart:      final hasPermission = await _checkGalleryPermission();
app/lib/pages/superadmin_articles_page.dart:      if (!hasPermission) {
app/lib/pages/superadmin_articles_page.dart:              content: Text('‚ùå Permission galerie refus√©e'),
app/lib/pages/group/admin_group_dashboard_page.dart:          role: 'admin',
app/lib/pages/group/tracker_group_profile_page.dart:          role: 'tracker',
app/lib/pages/group/group_track_history_page.dart:            _buildDetailRow('R√¥le', session.role),
app/lib/pages/home_map_page_web.dart:    final ok = await _ensureLocationPermission(request: true);
app/lib/pages/home_map_page_web.dart:  Future<bool> _ensureLocationPermission({required bool request}) async {
app/lib/pages/home_map_page_web.dart:      var permission = await Geolocator.checkPermission();
app/lib/pages/home_map_page_web.dart:      if (permission == LocationPermission.denied && request) {
app/lib/pages/home_map_page_web.dart:        permission = await Geolocator.requestPermission();
app/lib/pages/home_map_page_web.dart:      if (permission == LocationPermission.denied ||
app/lib/pages/home_map_page_web.dart:          permission == LocationPermission.deniedForever) {
app/lib/pages/home_map_page_web.dart:    final ok = await _ensureLocationPermission(request: true);
app/lib/pages/home_map_page_web.dart:        final role = doc.data()?['role'] as String?;
app/lib/pages/home_map_page_web.dart:        final isAdmin = doc.data()?['isAdmin'] as bool? ?? false;
app/lib/pages/home_map_page_web.dart:            role == 'superAdmin' ||
app/lib/pages/home_map_page_web.dart:            role == 'superadmin' ||
app/lib/pages/home_map_page_web.dart:            (isAdmin && (role == 'admin' || role == 'Admin'));
app/lib/pages/default_map_page.dart:    final ok = await _ensureLocationPermission(request: true);
app/lib/pages/default_map_page.dart:  Future<bool> _ensureLocationPermission({required bool request}) async {
app/lib/pages/default_map_page.dart:      var permission = await Geolocator.checkPermission();
app/lib/pages/default_map_page.dart:      if (permission == LocationPermission.denied && request) {
app/lib/pages/default_map_page.dart:        permission = await Geolocator.requestPermission();
app/lib/pages/default_map_page.dart:      if (permission == LocationPermission.denied) {
app/lib/pages/default_map_page.dart:      if (permission == LocationPermission.deniedForever) {
app/lib/pages/account_admin_page.dart:        final isAdmin = (data['isAdmin'] == true);
app/lib/pages/account_admin_page.dart:        final role = (data['role'] ?? '').toString().trim().toLowerCase();
app/lib/pages/account_admin_page.dart:        final isSuperAdmin = role == 'superadmin';
app/lib/pages/account_admin_page.dart:                        isAdmin: isAdmin,
app/lib/pages/account_admin_page.dart:                      if (isAdmin) ...[
app/lib/pages/account_admin_page.dart:  final bool isAdmin;

### 4.6 Firestore queries (collections & where)

app/lib/admin/admin_system_settings_page.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/admin_system_settings_page.dart:      final configDoc = await _firestore.collection('config').doc('system').get();
app/lib/admin/admin_system_settings_page.dart:      await _firestore.collection('config').doc('system').set(
app/lib/admin/create_circuit_assistant_page.dart:    final service = MarketMapService(firestore: FirebaseFirestore.instance);
app/lib/admin/create_circuit_assistant_page.dart:                  return _kCountryOptions.where(
app/lib/admin/mapmarket_projects_page.dart:  final _db = FirebaseFirestore.instance;
app/lib/admin/mapmarket_projects_page.dart:    Query query = _db.collection('map_projects').orderBy('updatedAt', descending: true);
app/lib/admin/mapmarket_projects_page.dart:      query = query.where('countryId', isEqualTo: _countryId);
app/lib/admin/mapmarket_projects_page.dart:      query = query.where('eventId', isEqualTo: _eventId);
app/lib/admin/mapmarket_projects_page.dart:    final ref = _db.collection('map_projects').doc();
app/lib/admin/mapmarket_projects_page.dart:    final now = FieldValue.serverTimestamp();
app/lib/admin/mapmarket_projects_page.dart:      final doc = ref.collection('layers').doc(l['type'] as String);
app/lib/admin/admin_orders_page.dart:  final _db = FirebaseFirestore.instance;
app/lib/admin/admin_orders_page.dart:                    .collection('orders')
app/lib/admin/admin_orders_page.dart:                    .orderBy('createdAt', descending: true)
app/lib/admin/admin_orders_page.dart:                    .limit(300)
app/lib/admin/admin_orders_page.dart:                      .where((o) {
app/lib/admin/admin_orders_page.dart:                    .where((s) => s != 'all')
app/lib/admin/admin_pois_simple_page.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/admin_pois_simple_page.dart:              stream: _firestore.collection('pois').snapshots(),
app/lib/admin/admin_pois_simple_page.dart:                var pois = snapshot.data!.docs.where((doc) {
app/lib/admin/admin_main_dashboard.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/admin_main_dashboard.dart:        ? _firestore.collection('shops').doc(shopId).collection('products')
app/lib/admin/admin_main_dashboard.dart:        : _firestore.collection('products');
app/lib/admin/admin_main_dashboard.dart:        .collection('commerce_submissions')
app/lib/admin/admin_main_dashboard.dart:        .where('status', isEqualTo: 'pending')
app/lib/admin/admin_main_dashboard.dart:        ? _firestore.collection('shops').doc(shopId).collection('products')
app/lib/admin/admin_main_dashboard.dart:        : _firestore.collection('products');
app/lib/admin/admin_main_dashboard.dart:    q = q.orderBy('updatedAt', descending: true).limit(400);
app/lib/admin/admin_main_dashboard.dart:                        .collection('productCategories')
app/lib/admin/admin_main_dashboard.dart:                        .limit(200)
app/lib/admin/admin_main_dashboard.dart:                            .collection('products')
app/lib/admin/admin_main_dashboard.dart:                            .orderBy('updatedAt', descending: true)
app/lib/admin/admin_main_dashboard.dart:                            .limit(800)
app/lib/admin/admin_tracking_page.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/admin_tracking_page.dart:    return _firestore.collection(_collection).snapshots();
app/lib/admin/admin_tracking_page.dart:        updatedAt: (data['updatedAt'] is Timestamp) 
app/lib/admin/admin_tracking_page.dart:            ? (data['updatedAt'] as Timestamp).toDate() 
app/lib/admin/admin_tracking_page.dart:        updatedAt: (data['updatedAt'] is Timestamp)
app/lib/admin/admin_tracking_page.dart:            ? (data['updatedAt'] as Timestamp).toDate()
app/lib/admin/category_management_page.dart:                        .where((cat) =>
app/lib/admin/role_management_page.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/role_management_page.dart:                stream: _firestore.collection('roles').orderBy('priority').snapshots(),
app/lib/admin/role_management_page.dart:                    roles = roles.where((doc) {
app/lib/admin/role_management_page.dart:          .collection('users')
app/lib/admin/role_management_page.dart:          .where('role', isEqualTo: roleId)
app/lib/admin/business_requests_page.dart:    await FirebaseFirestore.instance.collection('businesses').doc(uid).update({
app/lib/admin/business_requests_page.dart:      'reviewedAt': FieldValue.serverTimestamp(),
app/lib/admin/business_requests_page.dart:      'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/business_requests_page.dart:      await FirebaseFirestore.instance.collection('businesses').doc(uid).update({
app/lib/admin/business_requests_page.dart:        'reviewedAt': FieldValue.serverTimestamp(),
app/lib/admin/business_requests_page.dart:        'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/business_requests_page.dart:    final q = FirebaseFirestore.instance
app/lib/admin/business_requests_page.dart:        .collection('businesses')
app/lib/admin/business_requests_page.dart:        .where('status', isEqualTo: 'pending')
app/lib/admin/business_requests_page.dart:        .orderBy('createdAt', descending: true)
app/lib/admin/business_requests_page.dart:        .limit(100);
app/lib/admin/business_requests_page.dart:    final q = FirebaseFirestore.instance
app/lib/admin/business_requests_page.dart:        .collection('businesses')
app/lib/admin/business_requests_page.dart:        .where('status', isEqualTo: 'active')
app/lib/admin/business_requests_page.dart:        .orderBy('reviewedAt', descending: true)
app/lib/admin/business_requests_page.dart:        .limit(100);
app/lib/admin/business_requests_page.dart:    final createdAt = data['createdAt'] as Timestamp?;
app/lib/admin/business_requests_page.dart:                    _buildDetailItem('Cr√©√© le', _formatTimestamp(data['createdAt'])),
app/lib/admin/business_requests_page.dart:                      _buildDetailItem('Valid√© le', _formatTimestamp(data['reviewedAt'])),
app/lib/admin/business_requests_page.dart:  String _formatTimestamp(dynamic timestamp) {
app/lib/admin/business_requests_page.dart:    if (timestamp is Timestamp) {
app/lib/admin/admin_product_categories_page.dart:  final _db = FirebaseFirestore.instance;
app/lib/admin/admin_product_categories_page.dart:                    .collection('productCategories')
app/lib/admin/admin_product_categories_page.dart:                    .orderBy('name')
app/lib/admin/admin_product_categories_page.dart:                    .limit(200)
app/lib/admin/admin_product_categories_page.dart:                        .collection('products')
app/lib/admin/admin_product_categories_page.dart:                        .orderBy('updatedAt', descending: true)
app/lib/admin/admin_product_categories_page.dart:                        .limit(800)
app/lib/admin/admin_product_categories_page.dart:                              .where((n) => n.isNotEmpty)
app/lib/admin/admin_product_categories_page.dart:                      final filtered = cats.where((c) {
app/lib/admin/admin_product_categories_page.dart:    await _db.collection('productCategories').doc(id).set({
app/lib/admin/admin_product_categories_page.dart:      'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_product_categories_page.dart:      'createdAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_product_categories_page.dart:          .collection('productCategories')
app/lib/admin/admin_product_categories_page.dart:          .where('name', isEqualTo: name)
app/lib/admin/admin_product_categories_page.dart:          .limit(20)
app/lib/admin/admin_product_categories_page.dart:          .collection('products')
app/lib/admin/admin_product_categories_page.dart:          .where('category', isEqualTo: from)
app/lib/admin/admin_product_categories_page.dart:          .orderBy(FieldPath.documentId)
app/lib/admin/admin_product_categories_page.dart:          .limit(350);
app/lib/admin/admin_product_categories_page.dart:          'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_product_categories_page.dart:              .collection('shops')
app/lib/admin/admin_product_categories_page.dart:              .doc(shopId)
app/lib/admin/admin_product_categories_page.dart:              .collection('products')
app/lib/admin/admin_product_categories_page.dart:              .doc(d.id);
app/lib/tests/article_test_helper.dart:  final FirebaseFirestore _firestore = FirebaseFirestore.instance;
app/lib/tests/article_test_helper.dart:      final docRef = _firestore.collection('superadmin_articles').doc();
app/lib/tests/article_test_helper.dart:          'testTimestamp': now.toIso8601String(),
app/lib/tests/article_test_helper.dart:        'createdAt': Timestamp.fromDate(now),
app/lib/tests/article_test_helper.dart:        'updatedAt': Timestamp.fromDate(now),
app/lib/tests/article_test_helper.dart:          .collection('superadmin_articles')
app/lib/tests/article_test_helper.dart:          .doc(articleId)
app/lib/tests/article_test_helper.dart:        'Timestamps pr√©sents': 
app/lib/tests/article_test_helper.dart:      final coverItem = listing.items.where((i) => i.name.startsWith('cover.')).toList();
app/lib/tests/article_test_helper.dart:          .collection('superadmin_articles')
app/lib/tests/article_test_helper.dart:          .doc(articleId)
app/lib/tests/article_test_helper.dart:          .collection('superadmin_articles')
app/lib/tests/article_test_helper.dart:          .doc(articleId)
app/lib/admin/circuit_wizard_entry_page.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/circuit_wizard_entry_page.dart:                  .collection('map_projects')
app/lib/admin/circuit_wizard_entry_page.dart:                  .where('uid', isEqualTo: _auth.currentUser?.uid ?? '')
app/lib/admin/circuit_wizard_entry_page.dart:                  .orderBy('updatedAt', descending: true)
app/lib/admin/circuit_wizard_entry_page.dart:        await _firestore.collection('map_projects').doc(projectId).delete();
app/lib/models/map_preset_model.dart:    return layers.where((layer) => layer.visible).toList();
app/lib/models/map_preset_model.dart:      layers: layers.where((layer) => layer.id != layerId).toList(),
app/lib/models/map_preset_model.dart:      'createdAt': Timestamp.fromDate(createdAt),
app/lib/models/map_preset_model.dart:      'updatedAt': Timestamp.fromDate(updatedAt),
app/lib/models/map_preset_model.dart:      createdAt: (map['createdAt'] as Timestamp?)?.toDate() ?? DateTime.now(),
app/lib/models/map_preset_model.dart:      updatedAt: (map['updatedAt'] as Timestamp?)?.toDate() ?? DateTime.now(),
app/lib/models/optimized_image.dart:      uploadedAt: (map['uploadedAt'] as Timestamp?)?.toDate() ?? DateTime.now(),
app/lib/models/optimized_image.dart:        'uploadedAt': Timestamp.fromDate(uploadedAt),
app/lib/admin/admin_tracking_page_v2.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/admin_tracking_page_v2.dart:    return _firestore.collection(_collection).snapshots();
app/lib/admin/admin_tracking_page_v2.dart:        updatedAt: (data['updatedAt'] is Timestamp) 
app/lib/admin/admin_tracking_page_v2.dart:            ? (data['updatedAt'] as Timestamp).toDate() 
app/lib/admin/admin_tracking_page_v2.dart:        updatedAt: (data['updatedAt'] is Timestamp)
app/lib/admin/admin_tracking_page_v2.dart:            ? (data['updatedAt'] as Timestamp).toDate()
app/lib/admin/create_product_dialog.dart:      final rootRef = FirebaseFirestore.instance.collection('products').doc();
app/lib/admin/create_product_dialog.dart:      final shopRef = FirebaseFirestore.instance
app/lib/admin/create_product_dialog.dart:          .collection('shops')
app/lib/admin/create_product_dialog.dart:          .doc(widget.shopId)
app/lib/admin/create_product_dialog.dart:          .collection('products')
app/lib/admin/create_product_dialog.dart:          .doc(productId);
app/lib/admin/create_product_dialog.dart:        // Timestamps
app/lib/admin/create_product_dialog.dart:        'createdAt': FieldValue.serverTimestamp(),
app/lib/admin/create_product_dialog.dart:        'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/create_product_dialog.dart:      final batch = FirebaseFirestore.instance.batch();
app/lib/models/market_circuit_models.dart:      createdAt: (data['createdAt'] as Timestamp?)?.toDate(),
app/lib/models/market_circuit_models.dart:      updatedAt: (data['updatedAt'] as Timestamp?)?.toDate(),
app/lib/models/market_circuit_models.dart:      publishedAt: (data['publishedAt'] as Timestamp?)?.toDate(),
app/lib/models/market_circuit_models.dart:      'createdAt': createdAt ?? FieldValue.serverTimestamp(),
app/lib/models/market_circuit_models.dart:      'updatedAt': updatedAt ?? FieldValue.serverTimestamp(),
app/lib/models/image_asset.dart:      uploadedAt: (map['uploadedAt'] as Timestamp?)?.toDate() ?? DateTime.now(),
app/lib/models/image_asset.dart:      'uploadedAt': Timestamp.fromDate(uploadedAt),
app/lib/models/image_asset.dart:      createdAt: (map['createdAt'] as Timestamp?)?.toDate() ?? DateTime.now(),
app/lib/models/image_asset.dart:      updatedAt: (map['updatedAt'] as Timestamp?)?.toDate(),
app/lib/models/image_asset.dart:      'createdAt': Timestamp.fromDate(createdAt),
app/lib/models/image_asset.dart:    if (updatedAt != null) map['updatedAt'] = Timestamp.fromDate(updatedAt!);
app/lib/models/image_asset.dart:      images.where((img) => img.id != coverImageId).toList()
app/lib/admin/circuit_wizard_pro_page.dart:        final doc = await FirebaseFirestore.instance
app/lib/admin/circuit_wizard_pro_page.dart:            .collection('map_projects')
app/lib/admin/circuit_wizard_pro_page.dart:            .doc(widget.projectId)
app/lib/admin/circuit_wizard_pro_page.dart:    final snapshot = await FirebaseFirestore.instance
app/lib/admin/circuit_wizard_pro_page.dart:        .collection('map_projects')
app/lib/admin/circuit_wizard_pro_page.dart:        .doc(widget.projectId)
app/lib/admin/circuit_wizard_pro_page.dart:        .collection('layers')
app/lib/admin/circuit_wizard_pro_page.dart:        .orderBy('zIndex')
app/lib/admin/circuit_wizard_pro_page.dart:    final snapshot = await FirebaseFirestore.instance
app/lib/admin/circuit_wizard_pro_page.dart:        .collection('map_projects')
app/lib/admin/circuit_wizard_pro_page.dart:        .doc(widget.projectId)
app/lib/admin/circuit_wizard_pro_page.dart:        .collection('pois')
app/lib/admin/circuit_wizard_pro_page.dart:          FirebaseFirestore.instance.collection('map_projects').doc().id;
app/lib/admin/circuit_wizard_pro_page.dart:      await FirebaseFirestore.instance
app/lib/admin/circuit_wizard_pro_page.dart:          .collection('map_projects')
app/lib/admin/circuit_wizard_pro_page.dart:          .doc(projectId)
app/lib/admin/circuit_wizard_pro_page.dart:        'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/circuit_wizard_pro_page.dart:        'createdAt': _draftData.isEmpty ? FieldValue.serverTimestamp() : null,
app/lib/admin/circuit_wizard_pro_page.dart:        final poisRef = FirebaseFirestore.instance
app/lib/admin/circuit_wizard_pro_page.dart:            .collection('map_projects')
app/lib/admin/circuit_wizard_pro_page.dart:            .doc(projectId)
app/lib/admin/circuit_wizard_pro_page.dart:            .collection('pois');
app/lib/admin/circuit_wizard_pro_page.dart:                        .where((l) => l.type != 'route')
app/lib/admin/circuit_wizard_pro_page.dart:    final poisForLayer = _pois.where((p) => p.layerType == layerType).toList();
app/lib/admin/circuit_wizard_pro_page.dart:          FirebaseFirestore.instance.collection('map_projects').doc().id;
app/lib/admin/circuit_wizard_pro_page.dart:      await FirebaseFirestore.instance
app/lib/admin/circuit_wizard_pro_page.dart:          .collection('map_projects')
app/lib/admin/circuit_wizard_pro_page.dart:          .doc(projectId)
app/lib/admin/circuit_wizard_pro_page.dart:        'publishedAt': FieldValue.serverTimestamp(),
app/lib/admin/circuit_wizard_pro_page.dart:        'updatedAt': FieldValue.serverTimestamp(),
app/lib/models/market_poi.dart:      if (value is Timestamp) return value.toDate();
app/lib/models/market_poi.dart:  Map<String, dynamic> toMap({bool withServerTimestamps = true}) {
app/lib/models/market_poi.dart:      if (withServerTimestamps) 'updatedAt': FieldValue.serverTimestamp(),
app/lib/models/market_event.dart:      'startDate': startDate != null ? Timestamp.fromDate(startDate!) : null,
app/lib/models/market_event.dart:      'endDate': endDate != null ? Timestamp.fromDate(endDate!) : null,
app/lib/models/market_event.dart:      'createdAt': createdAt != null ? Timestamp.fromDate(createdAt!) : null,
app/lib/models/market_event.dart:      'updatedAt': updatedAt != null ? Timestamp.fromDate(updatedAt!) : null,
app/lib/models/market_event.dart:      if (value is Timestamp) return value.toDate();
app/lib/admin/admin_products_page.dart:  final _firestore = FirebaseFirestore.instance;
app/lib/admin/admin_products_page.dart:            .where((path) => path.startsWith('assets/shop/'))
app/lib/admin/admin_products_page.dart:            .where(
app/lib/admin/admin_products_page.dart:        .where((p) => p.trim().isNotEmpty)
app/lib/admin/admin_products_page.dart:    final now = FieldValue.serverTimestamp();
app/lib/admin/admin_products_page.dart:        final rootRef = _firestore.collection('products').doc(id);
app/lib/admin/admin_products_page.dart:            .collection('shops')
app/lib/admin/admin_products_page.dart:            .doc(widget.shopId)
app/lib/admin/admin_products_page.dart:            .collection('products')
app/lib/admin/admin_products_page.dart:            .doc(id);
app/lib/admin/admin_products_page.dart:          .collection('productCategories')
app/lib/admin/admin_products_page.dart:          .orderBy('name')
app/lib/admin/admin_products_page.dart:          .limit(200)
app/lib/admin/admin_products_page.dart:              .where((c) => c.isNotEmpty)
app/lib/admin/admin_products_page.dart:                          .where((g) => g != 'Tous')
app/lib/admin/admin_products_page.dart:                  .collection('products')
app/lib/admin/admin_products_page.dart:                  .orderBy('createdAt', descending: true)
app/lib/admin/admin_products_page.dart:                var products = snapshot.data!.docs.where((doc) {
app/lib/admin/admin_products_page.dart:      await _firestore.collection('products').doc(productId).update({
app/lib/admin/admin_products_page.dart:        'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_products_page.dart:          .collection('shops')
app/lib/admin/admin_products_page.dart:          .doc(shopId)
app/lib/admin/admin_products_page.dart:          .collection('products')
app/lib/admin/admin_products_page.dart:          .doc(productId)
app/lib/admin/admin_products_page.dart:            'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_products_page.dart:                          .collection('products')
app/lib/admin/admin_products_page.dart:                          .doc(productId)
app/lib/admin/admin_products_page.dart:                            'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_products_page.dart:                            .collection('shops')
app/lib/admin/admin_products_page.dart:                            .doc(shopIdFromDoc)
app/lib/admin/admin_products_page.dart:                            .collection('products')
app/lib/admin/admin_products_page.dart:                            .doc(productId)
app/lib/admin/admin_products_page.dart:                              'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_products_page.dart:        await _firestore.collection('products').doc(productId).delete();
app/lib/admin/admin_products_page.dart:            .collection('shops')
app/lib/admin/admin_products_page.dart:            .doc(shopId ?? widget.shopId)
app/lib/admin/admin_products_page.dart:            .collection('products')
app/lib/admin/admin_products_page.dart:            .doc(productId)
app/lib/models/circuit_model.dart:    final created = data['createdAt'] as Timestamp?;
app/lib/models/circuit_model.dart:    final created = data['createdAt'] as Timestamp?;
app/lib/models/circuit_model.dart:      'createdAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_stock_page.dart:  final _db = FirebaseFirestore.instance;
app/lib/admin/admin_stock_page.dart:          .collection('shops')
app/lib/admin/admin_stock_page.dart:          .doc(shopId)
app/lib/admin/admin_stock_page.dart:          .collection('products')
app/lib/admin/admin_stock_page.dart:          .collection('products')
app/lib/admin/admin_stock_page.dart:          .where('shopId', isEqualTo: shopId)
app/lib/admin/admin_stock_page.dart:          .collection('shops')
app/lib/admin/admin_stock_page.dart:          .doc(shopId)
app/lib/admin/admin_stock_page.dart:          .collection('products')
app/lib/admin/admin_stock_page.dart:          .collection('products')
app/lib/admin/admin_stock_page.dart:          .where('shopId', isEqualTo: shopId)
app/lib/admin/admin_stock_page.dart:        data['updatedAt'] = FieldValue.serverTimestamp();
app/lib/admin/admin_stock_page.dart:        final ref = _db.collection('products').doc(id);
app/lib/admin/admin_stock_page.dart:        data['updatedAt'] = FieldValue.serverTimestamp();
app/lib/admin/admin_stock_page.dart:            .collection('shops')
app/lib/admin/admin_stock_page.dart:            .doc(shopId)
app/lib/admin/admin_stock_page.dart:            .collection('products')
app/lib/admin/admin_stock_page.dart:            .doc(id);
app/lib/admin/admin_stock_page.dart:                  .collection('shops')
app/lib/admin/admin_stock_page.dart:                  .doc(widget.shopId)
app/lib/admin/admin_stock_page.dart:                  .collection('products')
app/lib/admin/admin_stock_page.dart:                  .orderBy('updatedAt', descending: true)
app/lib/admin/admin_stock_page.dart:                  .limit(400)
app/lib/admin/admin_stock_page.dart:                  .collection('products')
app/lib/admin/admin_stock_page.dart:                  .orderBy('updatedAt', descending: true)
app/lib/admin/admin_stock_page.dart:                  .limit(400)
app/lib/admin/admin_stock_page.dart:                  final docs = snap.data!.docs.where((d) {
app/lib/admin/admin_stock_page.dart:                          'updatedAt': FieldValue.serverTimestamp(),
app/lib/admin/admin_stock_page.dart:                            .collection('products')
app/lib/admin/admin_stock_page.dart:                            .doc(productId)
app/lib/admin/admin_stock_page.dart:                              .collection('shops')
app/lib/admin/admin_stock_page.dart:                              .doc(shopId)
app/lib/admin/admin_stock_page.dart:                              .collection('products')
app/lib/admin/admin_stock_page.dart:                              .doc(productId)
app/lib/models/group_tracker.dart:      createdAt: (data['createdAt'] as Timestamp?)?.toDate() ?? DateTime.now(),
app/lib/models/group_tracker.dart:      updatedAt: (data['updatedAt'] as Timestamp?)?.toDate() ?? DateTime.now(),

### 4.7 Functions Stripe / checkout / webhook / orders

functions/package-lock.json:        "stripe": "^17.5.0"
functions/package-lock.json:        "@js-sdsl/ordered-map": "^4.4.2"
functions/package-lock.json:    "node_modules/@js-sdsl/ordered-map": {
functions/package-lock.json:      "resolved": "https://registry.npmjs.org/@js-sdsl/ordered-map/-/ordered-map-4.4.2.tgz",
functions/package-lock.json:    "node_modules/stripe": {
functions/package-lock.json:      "resolved": "https://registry.npmjs.org/stripe/-/stripe-17.7.0.tgz",
functions/package.json:    "stripe": "^17.5.0"
functions/index.js:const stripeModule = require("stripe");
functions/index.js:let stripe = null;
functions/index.js:  if (!stripe) {
functions/index.js:    stripe = stripeModule(apiKey);
functions/index.js:  return stripe;
functions/index.js:  // Stripe client specifically pinned for createStorexPaymentIntent
functions/index.js:  return stripeModule(apiKey, { apiVersion: "2024-06-20" });
functions/index.js:    .where("stripe.subscriptionId", "==", subscriptionId)
functions/index.js:        .orderBy("lastLocation.geohash")
functions/index.js: * createStorexPaymentIntent (callable)
functions/index.js: * Lit users/{uid}/cart (source de v√©rit√©), cr√©e users/{uid}/orders/{orderId}
functions/index.js: * puis renvoie { orderId, clientSecret }.
functions/index.js:exports.createStorexPaymentIntent = onCall(
functions/index.js:  // 3) Cr√©er order
functions/index.js:  const orderRef = admin
functions/index.js:    .collection("orders")
functions/index.js:  // orderNo: g√©n√©rer un num√©ro de commande lisible (ORD-YYYYMMDD-shortId)
functions/index.js:  const shortId = orderRef.id.slice(0, 6).toUpperCase();
functions/index.js:  const orderNo = `ORD-${datePart}-${shortId}`;
functions/index.js:  await orderRef.set({
functions/index.js:    orderNo,
functions/index.js:    paymentMethod: "stripe",
functions/index.js:  // 3b) Miroir dans /orders/{orderId} pour l'admin + pages commandes
functions/index.js:  // Sch√©ma compatible avec app/lib/models/order_model.dart
functions/index.js:  const rootOrderRef = admin.firestore().collection("orders").doc(orderRef.id);
functions/index.js:      orderNo,
functions/index.js:  // 4) PaymentIntent
functions/index.js:  const stripeClient = getStripeV20240620();
functions/index.js:  const pi = await stripeClient.paymentIntents.create(
functions/index.js:      metadata: { uid, orderId: orderRef.id },
functions/index.js:    { idempotencyKey: orderRef.id }
functions/index.js:  await orderRef.update({
functions/index.js:    stripe: { paymentIntentId: pi.id },
functions/index.js:      stripe: { paymentIntentId: pi.id },
functions/index.js:    orderId: orderRef.id,
functions/index.js: * createCheckoutSessionForOrder
functions/index.js: * Cr√©e une Stripe Checkout Session pour une commande en attente
functions/index.js: * { orderId: string }
functions/index.js: * Returns: { checkoutUrl: string }
functions/index.js:exports.createCheckoutSessionForOrder = onCall(
functions/index.js:    const { orderId } = request.data || {};
functions/index.js:    if (!orderId || typeof orderId !== "string") {
functions/index.js:      throw new HttpsError("invalid-argument", "orderId is required");
functions/index.js:    const orderRef = db.collection("users").doc(uid).collection("orders").doc(orderId);
functions/index.js:    const orderSnap = await orderRef.get();
functions/index.js:    if (!orderSnap.exists) {
functions/index.js:      throw new HttpsError("not-found", `Order ${orderId} not found`);
functions/index.js:    const orderData = orderSnap.data();
functions/index.js:    if (orderData?.stripeSessionUrl && typeof orderData.stripeSessionUrl === "string") {
functions/index.js:      return { checkoutUrl: orderData.stripeSessionUrl };
functions/index.js:    if (orderData.status !== "pending") {
functions/index.js:        `Order ${orderId} is not in pending status (current: ${orderData.status})`
functions/index.js:    // IMPORTANT: Ne jamais faire confiance aux montants venant de users/{uid}/orders.
functions/index.js:    const items = orderData.items || [];
functions/index.js:        throw new HttpsError("failed-precondition", "Missing photoId in order item");
functions/index.js:    // 3. Cr√©e une Checkout Session Stripe
functions/index.js:      const stripeClient = getStripe();
functions/index.js:      const session = await stripeClient.checkout.sessions.create(
functions/index.js:        success_url: `https://maslive.web.app/success?orderId=${orderId}`,
functions/index.js:        cancel_url: `https://maslive.web.app/cancel?orderId=${orderId}`,
functions/index.js:          orderId,
functions/index.js:        { idempotencyKey: `users_${uid}_order_${orderId}` }
functions/index.js:      await orderRef.update({
functions/index.js:        stripeSessionId: session.id,
functions/index.js:        stripeSessionUrl: session.url,
functions/index.js:      return { checkoutUrl: session.url };
functions/index.js:        `Failed to create checkout session: ${error.message}`
functions/index.js: * createCheckoutSession (HTTP)
functions/index.js: * Body: { orderId, successUrl, cancelUrl }
functions/index.js: * - Lit /orders/{orderId}
functions/index.js:exports.createCheckoutSession = onRequest(
functions/index.js:      const { orderId, successUrl, cancelUrl } = req.body || {};
functions/index.js:      if (!orderId || typeof orderId !== "string") {
functions/index.js:        return res.status(400).json({ error: "orderId required" });
functions/index.js:      if (!isAllowedRedirectUrl(successUrl) || !isAllowedRedirectUrl(cancelUrl)) {
functions/index.js:          .json({ error: "successUrl & cancelUrl required (https)" });
functions/index.js:      const orderRef = db.collection("orders").doc(orderId);
functions/index.js:      const orderSnap = await orderRef.get();
functions/index.js:      if (!orderSnap.exists) {
functions/index.js:        return res.status(404).json({ error: "order not found" });
functions/index.js:      const order = orderSnap.data() || {};
functions/index.js:      const orderUid = typeof order.uid === "string" ? order.uid : (typeof order.userId === "string" ? order.userId : "");
functions/index.js:      if (!orderUid || orderUid !== uid) {
functions/index.js:      const status = (order.status || "pending").toString();
functions/index.js:        return res.status(409).json({ error: `order status is ${status}` });
functions/index.js:      const items = Array.isArray(order.items) ? order.items : [];
functions/index.js:        return res.status(400).json({ error: "order has no items (priceId missing)" });
functions/index.js:      const stripeClient = getStripe();
functions/index.js:      const session = await stripeClient.checkout.sessions.create(
functions/index.js:          cancel_url: cancelUrl,
functions/index.js:            orderId,
functions/index.js:          client_reference_id: orderId,
functions/index.js:        { idempotencyKey: `order_${orderId}` }
functions/index.js:      await orderRef.set(
functions/index.js:          stripe: {
functions/index.js:      console.error("createCheckoutSession error", e);
functions/index.js: * createSubscriptionCheckoutSession (HTTP)
functions/index.js: * Body: { priceId, successUrl, cancelUrl }
functions/index.js:exports.createSubscriptionCheckoutSession = onRequest(
functions/index.js:      const { priceId, successUrl, cancelUrl } = req.body || {};
functions/index.js:      if (!isAllowedRedirectUrl(successUrl) || !isAllowedRedirectUrl(cancelUrl)) {
functions/index.js:          .json({ error: "successUrl & cancelUrl required (https)" });
functions/index.js:      const stripeClient = getStripe();
functions/index.js:      const session = await stripeClient.checkout.sessions.create(
functions/index.js:          cancel_url: cancelUrl,
functions/index.js:              status: "checkout_pending",
functions/index.js:            stripe: {
functions/index.js:              pendingCheckoutSessionId: session.id,
functions/index.js:      console.error("createSubscriptionCheckoutSession error", e);
functions/index.js: * Cr√©e une Checkout Session Stripe pour le Media Shop (photos vendues)
functions/index.js: * Returns: { checkoutUrl: string }
functions/index.js:        "You can only create orders for yourself"
functions/index.js:    const orderRef = db.collection("users").doc(uid).collection("orders").doc();
functions/index.js:    const orderId = orderRef.id;
functions/index.js:    const orderData = {
functions/index.js:    await orderRef.set(orderData);
functions/index.js:    // 4. Cr√©e une Checkout Session Stripe
functions/index.js:      const stripeClient = getStripe();
functions/index.js:      const session = await stripeClient.checkout.sessions.create(
functions/index.js:          success_url: `https://maslive.web.app/success?orderId=${orderId}`,
functions/index.js:          cancel_url: `https://maslive.web.app/cancel?orderId=${orderId}`,
functions/index.js:            orderId,
functions/index.js:        { idempotencyKey: `mediaShop_${uid}_${orderId}` }
functions/index.js:      await orderRef.update({
functions/index.js:        stripeSessionId: session.id,
functions/index.js:        stripeSessionUrl: session.url,
functions/index.js:      // 6. NE PAS vider le panier ici : attendre la confirmation de paiement (webhook checkout.session.completed)
functions/index.js:      // Le panier sera vid√© par handleCheckoutSessionCompleted() apr√®s paiement confirm√©.
functions/index.js:      return { checkoutUrl: session.url };
functions/index.js:        `Failed to create checkout session: ${error.message}`
functions/index.js:    const stripeClient = getStripe();
functions/index.js:    let accountId = business.stripe && business.stripe.accountId;
functions/index.js:      const account = await stripeClient.accounts.create({
functions/index.js:          stripe: {
functions/index.js:    const refreshUrl = `${baseUrl}?stripeConnect=refresh`;
functions/index.js:    const returnUrl = `${baseUrl}?stripeConnect=return`;
functions/index.js:    const link = await stripeClient.accountLinks.create({
functions/index.js:    const accountId = business.stripe && business.stripe.accountId;
functions/index.js:    const stripeClient = getStripe();
functions/index.js:    const account = await stripeClient.accounts.retrieve(accountId);
functions/index.js:        stripe: {
functions/index.js: * stripeWebhook
functions/index.js: * Endpoint pour recevoir les √©v√©nements webhook de Stripe.
functions/index.js: * Configure dans le dashboard Stripe: https://dashboard.stripe.com/webhooks
functions/index.js: * URL: https://us-east1-maslive.cloudfunctions.net/stripeWebhook
functions/index.js: * - checkout.session.completed: Commande pay√©e (Media Shop)
functions/index.js:exports.stripeWebhook = onRequest(
functions/index.js:    // CORS non n√©cessaire pour les webhooks (appel√©s par Stripe directement)
functions/index.js:    const sig = req.headers["stripe-signature"];
functions/index.js:    const webhookSecret = getStripeWebhookSecret();
functions/index.js:    if (!webhookSecret) {
functions/index.js:      const stripeClient = getStripe();
functions/index.js:      // V√©rification de la signature du webhook (s√©curit√©)
functions/index.js:      event = stripeClient.webhooks.constructEvent(
functions/index.js:        webhookSecret
functions/index.js:        case "checkout.session.completed":
functions/index.js:          await handleCheckoutSessionCompleted(event.data.object);
functions/index.js:          await handlePaymentIntentSucceeded(event.data.object);
functions/index.js:      console.error("Error processing webhook:", error);
functions/index.js: * Traite l'√©v√©nement checkout.session.completed
functions/index.js:async function handleCheckoutSessionCompleted(session) {
functions/index.js:  console.log("Processing checkout.session.completed:", session.id);
functions/index.js:  // - Nouveau mod√®le simple: /orders/{orderId}
functions/index.js:  // - Mod√®le existant Media Shop: /users/{uid}/orders/{orderId}
functions/index.js:  const orderId = session.metadata?.orderId || session.client_reference_id;
functions/index.js:  if (!orderId) {
functions/index.js:    console.warn("Missing orderId in session metadata");
functions/index.js:  // 1) Essaye d'abord /orders/{orderId}
functions/index.js:  const rootOrderRef = db.collection("orders").doc(orderId);
functions/index.js:        stripe: {
functions/index.js:        .doc(orderId)
functions/index.js:            orderId,
functions/index.js:    console.log(`Root order ${orderId} marked as paid`);
functions/index.js:  // 2) Fallback vers mod√®le existant users/{uid}/orders/{orderId}
functions/index.js:    console.warn("Missing uid/userId in session metadata for users orders");
functions/index.js:  const userOrderRef = db.collection("users").doc(uid).collection("orders").doc(orderId);
functions/index.js:    console.warn(`Order ${orderId} not found (root nor user ${uid})`);
functions/index.js:  const order = userOrderSnap.data() || {};
functions/index.js:    stripeSessionId: session.id,
functions/index.js:    stripePaymentIntentId: session.payment_intent,
functions/index.js:  const items = order.items || [];
functions/index.js:      orderId,
functions/index.js:      stripeSessionId: session.id,
functions/index.js:  console.log(`User order ${orderId} marked as paid, ${items.length} purchases created`);
functions/index.js:        stripe: {
functions/index.js:        stripe: {
functions/index.js:async function handlePaymentIntentSucceeded(paymentIntent) {
functions/index.js:  const orderId = paymentIntent.metadata?.orderId;
functions/index.js:  if (!uid || !orderId) {
functions/index.js:    console.warn("Missing uid or orderId in payment intent metadata");
functions/index.js:  const orderRef = db
functions/index.js:    .collection("orders")
functions/index.js:    .doc(orderId);
functions/index.js:  await orderRef.set(
functions/index.js:      stripe: {
functions/index.js:  // Miroir root order (si pr√©sent)
functions/index.js:  const rootOrderRef = db.collection("orders").doc(orderId);
functions/index.js:      stripe: {
functions/index.js:  console.log(`Order ${orderId} marked as paid via payment_intent.succeeded`);
functions/index.js:      stripe: {
functions/index.js:  console.log(`Business ${uid} Stripe status auto-updated via webhook`);

## 5) Localisation de fichiers cl√©s (best effort)

### ProductService (ou √©quivalent) ‚Äî introuvable automatiquement

### StorageService (ou √©quivalent) ‚Äî `app/lib/services/storage_service.dart`

```
import 'package:firebase_storage/firebase_storage.dart';
import 'package:firebase_auth/firebase_auth.dart';
import 'package:image_picker/image_picker.dart';
import 'package:flutter/foundation.dart' show kIsWeb;
import 'package:flutter/services.dart' show rootBundle;
import 'dart:developer' as developer;

/// Service centralis√© de gestion du stockage Firebase Storage
/// 
/// Structure organis√©e :
/// - products/{shopId}/{productId}/original/{index}.jpg
/// - media/{scopeId}/{mediaId}/original/media.jpg
/// - articles/{articleId}/original/cover.jpg
/// - groups/{groupId}/products/{productId}/original/{index}.jpg
/// - users/{userId}/avatar/original.jpg
/// 
/// Voir STORAGE_STRUCTURE.md pour la documentation compl√®te
class StorageService {
  static final StorageService instance = StorageService._internal();
  StorageService._internal();

  final FirebaseStorage _storage = FirebaseStorage.instance;
  final FirebaseAuth _auth = FirebaseAuth.instance;

  User? get _currentUser => _auth.currentUser;

  // ========== PRODUITS ==========

  /// Upload photos d'un produit (boutique)
  /// 
  /// Retourne la liste des URLs des photos upload√©es
  Future<List<String>> uploadProductPhotos({
    required String productId,
    required List<XFile> files,
    String shopId = 'global',
    void Function(double progress)? onProgress,
  }) async {
    if (files.isEmpty) return [];
    
    final urls = <String>[];
    final totalFiles = files.length;

    for (var i = 0; i < files.length; i++) {
      final file = files[i];
      final path = 'products/$shopId/$productId/original/$i.jpg';
      
      final url = await _uploadFile(
        file: file,
        path: path,
        category: 'product',
        parentId: productId,
        parentType: 'product',
        onProgress: (fileProgress) {
          final totalProgress = (i + fileProgress) / totalFiles;
          onProgress?.call(totalProgress);
        },
      );
      
      urls.add(url);
    }

    return urls;
  }

  /// Upload une seule photo de produit
  Future<String> uploadProductPhoto({
    required String productId,
    required XFile file,
    String shopId = 'global',
    int index = 0,
    void Function(double progress)? onProgress,
  }) async {
    final path = 'products/$shopId/$productId/original/$index.jpg';
    
    return await _uploadFile(
      file: file,
      path: path,
      category: 'product',
      parentId: productId,
      parentType: 'product',
      onProgress: onProgress,
    );
  }

  /// Supprime toutes les photos d'un produit
  Future<void> deleteProductPhotos({
    required String productId,
    String shopId = 'global',
  }) async {
    final folderRef = _storage.ref('products/$shopId/$productId');
    await _deleteFolder(folderRef);
  }

  // ========== M√âDIAS ==========

  /// Upload m√©dias (photos/vid√©os) pour galerie/instagram
  Future<List<String>> uploadMediaFiles({
    required String mediaId,
    required List<XFile> files,
    String scopeId = 'global',
    void Function(double progress)? onProgress,
  }) async {
    if (files.isEmpty) return [];
    
    final urls = <String>[];
    final totalFiles = files.length;

    for (var i = 0; i < files.length; i++) {
      final file = files[i];
      final ext = _getExtension(file.name);
      final path = 'media/$scopeId/$mediaId/original/media_$i.$ext';
      
      final url = await _uploadFile(
        file: file,
        path: path,
        category: 'media',
        parentId: mediaId,
        parentType: 'media',
        onProgress: (fileProgress) {
          final totalProgress = (i + fileProgress) / totalFiles;
          onProgress?.call(totalProgress);
        },
      );
      
      urls.add(url);
    }

    return urls;
  }

  /// Upload un seul m√©dia
  Future<String> uploadMediaFile({
    required String mediaId,
    required XFile file,
    String scopeId = 'global',
    void Function(double progress)? onProgress,
  }) async {
    final ext = _getExtension(file.name);
    final path = 'media/$scopeId/$mediaId/original/media.$ext';
    
    return await _uploadFile(
      file: file,
      path: path,
      category: 'media',
      parentId: mediaId,
      parentType: 'media',
      onProgress: onProgress,
    );
  }

  /// Supprime tous les m√©dias
  Future<void> deleteMediaFiles({
    required String mediaId,
    String scopeId = 'global',
  }) async {
    final folderRef = _storage.ref('media/$scopeId/$mediaId');
    await _deleteFolder(folderRef);
  }

  // ========== ARTICLES ==========

  /// Upload image de couverture d'article
  Future<String> uploadArticleCover({
    required String articleId,
    required XFile file,
    void Function(double progress)? onProgress,
  }) async {
    final path = 'articles/$articleId/original/cover.jpg';
    
    return await _uploadFile(
      file: file,
      path: path,
      category: 'article',
      parentId: articleId,
      parentType: 'article',
      onProgress: onProgress,
    );
  }

  /// Upload image d'article depuis les assets (maslivelogo.png, etc.)
  Future<String> uploadArticleFromAsset({
    required String articleId,
    required String assetPath, // ex: assets/images/maslivelogo.png
    void Function(double progress)? onProgress,
  }) async {
    developer.log('üì¶ [StorageService] Upload depuis asset: $assetPath');
    
    final user = _currentUser;
    if (user == null) {
      developer.log('‚ùå [StorageService] User non authentifi√©');
      throw Exception('User not authenticated');
    }

    try {
      // 1. Charger asset en bytes
      final data = await rootBundle.load(assetPath);
      final bytes = data.buffer.asUint8List();
      developer.log('‚úÖ [StorageService] Asset charg√©: ${bytes.length} bytes');

      // 2. Extraire nom original
      final fileName = assetPath.split('/').last;
      final ext = fileName.split('.').last;

      // 3. D√©terminer chemin storage
      final path = 'articles/$articleId/original/cover.$ext';

      // 4. Uploader
      final ref = _storage.ref(path);
      final metadata = SettableMetadata(
        contentType: _getContentType(fileName),
        customMetadata: {
          'uploadedBy': user.uid,
          'uploadedAt': DateTime.now().toIso8601String(),
          'originalName': fileName,
          'originalPath': assetPath,
          'category': 'article_asset',
          'parentId': articleId,
          'parentType': 'article',
        },
      );

      developer.log('üîß [StorageService] Upload asset vers: $path');
      final uploadTask = ref.putData(bytes, metadata);

      if (onProgress != null) {
        uploadTask.snapshotEvents.listen((snapshot) {
          final progress = snapshot.bytesTransferred / snapshot.totalBytes;
          onProgress(progress);
        });
      }

      await uploadTask;
      final downloadUrl = await ref.getDownloadURL();
      developer.log('‚úÖ [StorageService] Asset upload√©: $downloadUrl');
      
      return downloadUrl;
    } catch (e) {
      developer.log('‚ùå [StorageService] Erreur upload asset: $e');
      rethrow;
    }
  }

  /// Upload images du contenu d'article
  Future<List<String>> uploadArticleContentImages({
    required String articleId,
    required List<XFile> files,
    void Function(double progress)? onProgress,
  }) async {
    if (files.isEmpty) return [];
    
    final urls = <String>[];
    final totalFiles = files.length;

    for (var i = 0; i < files.length; i++) {
      final file = files[i];
      final path = 'articles/$articleId/original/content_$i.jpg';
      
      final url = await _uploadFile(
        file: file,
        path: path,
```

### AddProduct (dans app/lib) ‚Äî introuvable automatiquement

### add_product.dart (racine repo) ‚Äî `add_product.dart`

```
// Fichier d√©plac√© vers app/tool/add_product.dart pour utiliser le pubspec Flutter.
```

### Drawer / Menu burger ‚Äî introuvable automatiquement

### Router / Routes ‚Äî `app/lib/pages/role_router_page.dart`

```
import 'package:flutter/material.dart';
import 'package:firebase_auth/firebase_auth.dart';
import '../models/user_profile_model.dart';
import '../services/auth_service.dart';

/// Route d'aiguillage selon le r√¥le Firestore.
class RoleRouterPage extends StatelessWidget {
  const RoleRouterPage({super.key});

  @override
  Widget build(BuildContext context) {
    final auth = AuthService();
    return StreamBuilder<User?>(
      stream: auth.authStateChanges,
      builder: (context, userSnap) {
        if (userSnap.connectionState == ConnectionState.waiting) {
          return const Scaffold(
            body: Center(child: CircularProgressIndicator()),
          );
        }

        if (!userSnap.hasData || userSnap.data == null) {
          // ‚úÖ Redirection vers la carte publique au lieu de login
          WidgetsBinding.instance.addPostFrameCallback((_) {
            Navigator.of(context).pushReplacementNamed('/');
          });
          return const Scaffold(
            body: Center(child: CircularProgressIndicator()),
          );
        }

        final user = userSnap.data!;
        return StreamBuilder<UserProfile?>(
          stream: auth.getUserProfileStream(user.uid),
          builder: (context, profileSnap) {
            if (profileSnap.connectionState == ConnectionState.waiting) {
              return const Scaffold(
                body: Center(child: CircularProgressIndicator()),
              );
            }

            final profile = profileSnap.data;
            if (profile == null) {
              Navigator.of(context).pushReplacementNamed('/login');
              return const Scaffold(
                body: Center(child: CircularProgressIndicator()),
              );
            }

            // Naviguer apr√®s le build pour √©viter les setState en build
            WidgetsBinding.instance.addPostFrameCallback((_) {
              switch (profile.role) {
                case UserRole.admin:
                  Navigator.of(context).pushReplacementNamed('/admin');
                  break;
                case UserRole.group:
                  Navigator.of(context).pushReplacementNamed(
                    '/app',
                    arguments: {'groupId': profile.groupId},
                  );
                  break;
                case UserRole.user:
                  Navigator.of(context).pushReplacementNamed('/');
                  break;
              }
            });

            return const Scaffold(
              body: Center(child: CircularProgressIndicator()),
            );
          },
        );
      },
    );
  }
}
```

### Profil admin (page) ‚Äî `app/lib/admin/user_profile_preview_page.dart`

```
import 'package:flutter/material.dart';

import '../widgets/rainbow_header.dart';
import '../widgets/honeycomb_background.dart';

/// Page de pr√©visualisation des diff√©rents types de profils utilisateurs
/// Permet au superadmin de voir comment se pr√©sente chaque type de profil
class UserProfilePreviewPage extends StatefulWidget {
  const UserProfilePreviewPage({super.key});

  @override
  State<UserProfilePreviewPage> createState() => _UserProfilePreviewPageState();
}

class _UserProfilePreviewPageState extends State<UserProfilePreviewPage> {
  // Types de profils √† afficher
  final List<String> _profileTypes = [
    'Utilisateur standard',
    'Compte Pro',
    'Cr√©ateur digital',
    'Administrateur groupe',
    'Tracker groupe',
    'Admin',
    'SuperAdmin',
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: HoneycombBackground(
        child: CustomScrollView(
          slivers: [
            const SliverToBoxAdapter(
              child: RainbowHeader(
                title: 'Aper√ßu Profils Utilisateurs',
              ),
            ),
            SliverPadding(
              padding: const EdgeInsets.all(16),
              sliver: SliverList(
                delegate: SliverChildBuilderDelegate(
                  (context, index) {
                    final profileType = _profileTypes[index];
                    return _ProfileTypeCard(
                      profileType: profileType,
                      onTap: () => _showProfilePreview(context, profileType),
                    );
                  },
                  childCount: _profileTypes.length,
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  void _showProfilePreview(BuildContext context, String profileType) {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true,
      backgroundColor: Colors.transparent,
      builder: (context) => DraggableScrollableSheet(
        initialChildSize: 0.9,
        minChildSize: 0.5,
        maxChildSize: 0.95,
        builder: (context, scrollController) {
          return Container(
            decoration: const BoxDecoration(
              color: Colors.white,
              borderRadius: BorderRadius.vertical(top: Radius.circular(20)),
            ),
            child: Column(
              children: [
                Container(
                  margin: const EdgeInsets.symmetric(vertical: 12),
                  width: 40,
                  height: 4,
                  decoration: BoxDecoration(
                    color: Colors.grey.shade300,
                    borderRadius: BorderRadius.circular(2),
                  ),
                ),
                Padding(
                  padding: const EdgeInsets.symmetric(horizontal: 16),
                  child: Row(
                    children: [
                      Expanded(
                        child: Text(
                          'Aper√ßu: $profileType',
                          style: const TextStyle(
                            fontSize: 18,
                            fontWeight: FontWeight.w900,
                          ),
                        ),
                      ),
                      IconButton(
                        icon: const Icon(Icons.close),
                        onPressed: () => Navigator.pop(context),
                      ),
                    ],
                  ),
                ),
                const Divider(),
                Expanded(
                  child: _buildProfilePreviewContent(
                    scrollController,
                    profileType,
                  ),
                ),
              ],
            ),
          );
        },
      ),
    );
  }

  Widget _buildProfilePreviewContent(
    ScrollController controller,
    String profileType,
  ) {
    return ListView(
      controller: controller,
      padding: const EdgeInsets.all(16),
      children: [
        // Avatar et infos basiques
        Center(
          child: Column(
            children: [
              CircleAvatar(
                radius: 50,
                backgroundColor: _getColorForProfile(profileType),
                child: Icon(
                  _getIconForProfile(profileType),
                  size: 50,
                  color: Colors.white,
                ),
              ),
              const SizedBox(height: 16),
              Text(
                _getExampleName(profileType),
                style: const TextStyle(
                  fontSize: 20,
                  fontWeight: FontWeight.w900,
                ),
              ),
              const SizedBox(height: 4),
              Container(
                padding: const EdgeInsets.symmetric(
                  horizontal: 12,
                  vertical: 6,
                ),
                decoration: BoxDecoration(
                  color: _getColorForProfile(profileType).withValues(alpha: 0.2),
                  borderRadius: BorderRadius.circular(20),
                  border: Border.all(
                    color: _getColorForProfile(profileType),
                    width: 1.5,
                  ),
                ),
                child: Text(
                  profileType,
                  style: TextStyle(
                    color: _getColorForProfile(profileType),
                    fontWeight: FontWeight.w700,
                    fontSize: 12,
                  ),
                ),
              ),
            ],
          ),
        ),
        const SizedBox(height: 32),

        // Sections disponibles selon le type
        _buildSectionTitle('Sections disponibles'),
        const SizedBox(height: 12),
        ..._getSectionsForProfile(profileType).map(
          (section) => _buildSectionCard(
            section['title'] as String,
            section['subtitle'] as String,
            section['icon'] as IconData,
          ),
        ),
        const SizedBox(height: 24),

        // Permissions
        _buildSectionTitle('Permissions'),
        const SizedBox(height: 12),
        ..._getPermissionsForProfile(profileType).map(
          (permission) => _buildPermissionItem(
            permission['label'] as String,
            permission['granted'] as bool,
          ),
        ),
        const SizedBox(height: 24),

        // Fonctionnalit√©s sp√©ciales
        if (_getSpecialFeatures(profileType).isNotEmpty) ...[
          _buildSectionTitle('Fonctionnalit√©s sp√©ciales'),
          const SizedBox(height: 12),
          ..._getSpecialFeatures(profileType).map(
            (feature) => _buildFeatureItem(feature),
          ),
        ],
      ],
    );
  }

  Widget _buildSectionTitle(String title) {
    return Text(
      title,
      style: const TextStyle(
        fontSize: 16,
        fontWeight: FontWeight.w900,
        color: Colors.black87,
      ),
    );
  }

  Widget _buildSectionCard(String title, String subtitle, IconData icon) {
    return Container(
      margin: const EdgeInsets.only(bottom: 12),
      padding: const EdgeInsets.all(16),
      decoration: BoxDecoration(
        color: Colors.white,
        borderRadius: BorderRadius.circular(12),
        border: Border.all(color: Colors.grey.shade200),
        boxShadow: [
          BoxShadow(
            color: Colors.black.withValues(alpha: 0.04),
            blurRadius: 8,
            offset: const Offset(0, 2),
          ),
        ],
      ),
      child: Row(
        children: [
          Container(
            padding: const EdgeInsets.all(12),
            decoration: BoxDecoration(
              color: Colors.grey.shade100,
              borderRadius: BorderRadius.circular(10),
            ),
            child: Icon(icon, color: Colors.grey.shade700),
          ),
          const SizedBox(width: 16),
          Expanded(
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  title,
                  style: const TextStyle(
                    fontWeight: FontWeight.w700,
                    fontSize: 14,
                  ),
                ),
```

### Boutique (page principale candidate) ‚Äî `app/lib/widgets/la_boutique_header.dart`

```
import 'package:flutter/material.dart';

/// Header pixel-perfect (style comme ton visuel) :
/// - Titre: "La boutique"
/// - Sous-titre: "Merch, stickers, accessoires & photos"
/// - Barre de recherche pill + bouton filtre d√©grad√©
/// - Coins arrondis en bas + ombre douce
class LaBoutiqueHeader extends StatelessWidget {
  const LaBoutiqueHeader({
    super.key,
    required this.onBack,
    required this.onCartIconTap,
    required this.onQueryChanged,
    this.cartCount,
    this.hintText = "Rechercher un article, un groupe‚Ä¶",
  });

  final VoidCallback onBack;
  final VoidCallback onCartIconTap;
  final ValueChanged<String> onQueryChanged;
  final int? cartCount;
  final String hintText;

  @override
  Widget build(BuildContext context) {
    final top = MediaQuery.of(context).padding.top;

    return Container(
      padding: EdgeInsets.fromLTRB(16, top + 8, 16, 10),
      decoration: BoxDecoration(
        gradient: const LinearGradient(
          begin: Alignment.topLeft,
          end: Alignment.bottomRight,
          stops: [0.00, 0.35, 0.72, 1.00],
          colors: [
            Color(0xFFFFB36A), // orange pastel
            Color(0xFFFF6FB1), // rose
            Color(0xFF8B7BFF), // violet
            Color(0xFF66C7FF), // bleu clair
          ],
        ),
        borderRadius: BorderRadius.zero,
        boxShadow: [
          BoxShadow(
            color: Colors.black.withValues(alpha: 0.10),
            blurRadius: 18,
            offset: const Offset(0, 10),
          ),
        ],
      ),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: [
          // Top bar (boutons + titres)
          Row(
            children: [
              _RoundIconGlassButton(
                icon: Icons.arrow_back_rounded,
                onTap: onBack,
              ),
              const SizedBox(width: 12),

              // Titres centr√©s visuellement (entre 2 boutons)
              Expanded(
                child: Column(
                  children: const [
                    Text(
                      "La boutique",
                      textAlign: TextAlign.center,
                      maxLines: 1,
                      overflow: TextOverflow.ellipsis,
                      style: TextStyle(
                        fontSize: 20,
                        height: 1.05,
                        fontWeight: FontWeight.w900,
                        letterSpacing: -0.6,
                        color: Color(0xFF111827),
                      ),
                    ),
                    SizedBox(height: 2),
                    Text(
                      "Merch, stickers, accessoires & photos",
                      textAlign: TextAlign.center,
                      maxLines: 1,
                      overflow: TextOverflow.ellipsis,
                      style: TextStyle(
                        fontSize: 10,
                        height: 1.15,
                        fontWeight: FontWeight.w600,
                        color: Color(0xFF1F2937),
                      ),
                    ),
                  ],
                ),
              ),

              const SizedBox(width: 12),
              Stack(
                clipBehavior: Clip.none,
                children: [
                  _RoundIconGlassButton(
                    icon: Icons.shopping_cart_rounded,
                    onTap: onCartIconTap,
                  ),
                  if ((cartCount ?? 0) > 0)
                    Positioned(
                      right: -2,
                      top: -2,
                      child: Container(
                        padding: const EdgeInsets.symmetric(
                          horizontal: 6,
                          vertical: 3,
                        ),
                        decoration: BoxDecoration(
                          color: const Color(0xFF111827),
                          borderRadius: BorderRadius.circular(999),
                          border: Border.all(
                            color: Colors.white.withValues(alpha: 0.8),
                            width: 1,
                          ),
                        ),
                        child: Text(
                          '${(cartCount ?? 0) > 99 ? '99+' : cartCount}',
                          style: const TextStyle(
                            color: Colors.white,
                            fontWeight: FontWeight.w900,
                            fontSize: 11,
                            height: 1.0,
                          ),
                        ),
                      ),
                    ),
                ],
              ),
            ],
          ),

          const SizedBox(height: 14),

          // Search pill
          _SearchPillExact(hintText: hintText, onChanged: onQueryChanged),
        ],
      ),
    );
  }
}

class _RoundIconGlassButton extends StatelessWidget {
  const _RoundIconGlassButton({required this.icon, required this.onTap});

  final IconData icon;
  final VoidCallback onTap;

  @override
  Widget build(BuildContext context) {
    return InkWell(
      onTap: onTap,
      borderRadius: BorderRadius.circular(999),
      child: Ink(
        width: 46,
        height: 46,
        decoration: BoxDecoration(
          color: Colors.white.withValues(alpha: 0.20),
          borderRadius: BorderRadius.circular(999),
          border: Border.all(
            color: Colors.white.withValues(alpha: 0.28),
            width: 1,
          ),
        ),
        child: Icon(icon, size: 22, color: const Color(0xFF111827)),
      ),
    );
  }
}

class _SearchPillExact extends StatelessWidget {
  const _SearchPillExact({required this.hintText, required this.onChanged});

  final String hintText;
  final ValueChanged<String> onChanged;

  @override
  Widget build(BuildContext context) {
    return Container(
      height: 54,
      padding: const EdgeInsets.symmetric(horizontal: 14),
      decoration: BoxDecoration(
        color: Colors.white.withValues(alpha: 0.90),
        borderRadius: BorderRadius.circular(999),
        border: Border.all(
          color: Colors.white.withValues(alpha: 0.70),
          width: 1,
        ),
        boxShadow: [
          BoxShadow(
            color: Colors.black.withValues(alpha: 0.06),
            blurRadius: 16,
            offset: const Offset(0, 10),
          ),
        ],
      ),
      child: Row(
        children: [
          const Icon(Icons.search_rounded, size: 22, color: Color(0xFF6B7280)),
          const SizedBox(width: 12),
          Expanded(
            child: TextField(
              onChanged: onChanged,
              textInputAction: TextInputAction.search,
              decoration: InputDecoration(
                hintText: hintText,
                hintStyle: const TextStyle(
                  fontSize: 16,
                  fontWeight: FontWeight.w600,
                  color: Color(0xFF6B7280),
                ),
                border: InputBorder.none,
                isDense: true,
              ),
              style: const TextStyle(
                fontSize: 16,
                fontWeight: FontWeight.w700,
                color: Color(0xFF111827),
              ),
            ),
          ),
        ],
      ),
    );
  }
}
```

## 6) R√©sum√©

- Dossier Dart: app/lib
- ProductService: NON
- StorageService: app/lib/services/storage_service.dart
- AddProduct (app/lib): NON
- add_product.dart (racine): add_product.dart
- Drawer: NON
- Router: app/lib/pages/role_router_page.dart
- Admin profile: app/lib/admin/user_profile_preview_page.dart
- Shop main: app/lib/widgets/la_boutique_header.dart

